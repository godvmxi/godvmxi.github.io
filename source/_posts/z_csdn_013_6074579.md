---
title: C语言编程开发中用好位操作符
description: <br /><br />1. C语言中的位操作符<br />因为C语言的设计目的是取代汇编语言，所以它必须支持汇编语言所具有的运算能力，所以C语言支持全部的位操作符(Bitwise Operators)。位操作是对字节或字中的位(bit)进行测试、置位或移位处理，在对微处理器的编程中，特别适合对寄存器、I/O端口进行操作。因而本节将对此作比较详细地介绍。<br />6种位操作符的形式与含义如下：<br />& ：按位“与”(AND)；<br />| ：按位“或”(OR)；<br />^ ：按位“异或”(XO
tags: CSDN
author: 蛋蛋_rmvb Csdn认证博客专家 Csdn认证企业博客 码龄14年 暂无认证
date: 2010-12-14T15:11:10.000Z
publisher: null
stats: paragraph=44 sentences=2, words=223
---
**1. C** **语言中的位操作符**

因为C语言的设计目的是取代汇编语言，所以它必须支持汇编语言所具有的运算能力，所以C语言支持全部的位操作符(Bitwise Operators)。位操作是对字节或字中的位(bit)进行测试、置位或移位处理，在对微处理器的编程中，特别适合对寄存器、I/O端口进行操作。因而本节将对此作比较详细地介绍。

6种位操作符的形式与含义如下：

> & ：按位"与"(AND)；
| ：按位"或"(OR)；
^ ：按位"异或"(XOR)；
~ ："取反" (NOT)；
>> ：数据右移；
<< ：数据左移；

**1)** **按位"与"运算**

按位"与"运算符 & 的作用是对运算符两侧以二进制表达的操作数按位分别进行"与"运算，而这一运算是以数中相同的位(bit)为单位的。操作的规则是：仅当两个操作数都为1时，输出的结果才为1，否则为0。

例如：

其中，& 运算符让a数0x88与B数0x81的1位与1位、2位与2位......7位与7位分别相"与"。由于"与"运算的操作规则是，两个操作数中各位只要有1个为0，其结果中对应的位就为0。而a数与b数中只有最高位(第7位)均为1，因而该位结果为1，其它各位结果都为0。

通常我们可把按位"与"操作 & 作为关闭某位(即将该位置0)的手段，例如我们想要关闭a数中的第3位，而又不影响其它位的现状，可以用一个数0xF7，即二进制数1111 0111去与a数作按位"与"运算：

> 0x88 1000 1000 a数
& 0xF7 1111 0111 屏蔽数
= 1000 0000

注意，这个数除第3位为0外，其它各位均为1，操作的结果只会将a数中的第3位置0，而a数的其它位不受影响。也就是说，若需要某个数的第n位关闭，只需要将该数与另一个数按位相与，另一个数除了相应的第n位为0外，其它各位都为1，以起到对其它各位的屏蔽作用。

上面的运算可以用a = a &(0xF7) 来表示，也可以用a & =(0xF7) 来表达。这两个表达式功能是相同的(见上节"复合赋值运算符"部分)，但在源程序代码中常常见到的以第二种形式为多。

**2)** **按位"或"运算**

按位"或" 运算符 | 的作用是对运算符两侧以二进制表达的操作数按位分别进行"或"运算，而这一运算是以数中相同的位(bit)为单位的。操作的规则是：仅当两个操作数都为0时，输出的结果才为0，否则为1。

例如：

通常我们可把按位"与"操作 & 作为置位(即将该位置1)的手段，例如我们想要将a数中的第0位和1位置1，而又不影响其它位的现状，可以用一个数0x03，即二进制数00000011去与a数作按位"或"运算：

> 0x88 1000 1000 a数
| 0x03 0000 0011 屏蔽数
= 1000 1011

注意，这个数除第0、1位为1外，其它各位均为0，操作的结果只会将a数中的第0、1位置0，而a数的其它位不受影响。也就是说，若需要某个数的第n位置1，只需要将该数与另一个数按位相"或"，另一个数除了相应的第n位为1外，其它各位都为0，以起到对其它各位的屏蔽作用。上面的运算可以用a = a | (0xF7) 来表示，也可以用a | =(0xF7) 来表达。

**3)** **按位"异或"运算**

按位"异或"运算符 ^ 的作用是对运算符两侧以二进制表达的操作数按位分别进行"异或"运算，而这一运算是以数中相同的位(bit)为单位的。异或运算操作的规则是：仅当两个操作数不同时，相应的输出结果才为1，否则为0。

例如：

> a = 0x88，b = 0x81，则a ^ b 的运算结果如下：
0x88 1000 1000 a数
^ 0x81 1000 0001 屏蔽数
= 0000 1001

按位"异或"运算 ^ 具有一些特殊的应用，介绍如下：

① 按位"异或"运算可以使特定的位取反

例如：我们想让a数中的最低位和最高位取反，只要用0x81，即二进制数10000001去与它作按位"异或"运算，其运算结果同上式。经过操作后，最高位的值已经由1变0，而最低位的值也已经由0变1，起到了使这两位翻转的效果。其它位的状态保持不变。

可以看到，这个数除最低位、最高位为1外，其它各位均为0，操作的结果只会将a数中的第0、7位取反，而a数的其它位不受影响。也就是说，若需要某个数的第n位取反，只需要将该数与另一个数按位相"异或"，另一个数除了相应的第n位为1外，其它各位都为0，以起到对其它各位的屏蔽作用。上面的运算可以用a = a ^ (0x81) 来表示，也可以用a ^ =(0x81) 来表达。

② 直接交换两个变量的值

例如，若有变量a = 3，b = 4，想要交换它们的值，可以做如下一组操作：

> a ^ = b
b ^ = a
a ^ = b
首先，a ^ = b:
a 0000 0011
^ b 0000 0100
a = 0000 0111
其次，b ^ = a:
b 0000 0100
^ a 0000 0111
b = 0000 0011
最后，a ^ = b:
a 0000 0111
^ b 0000 0011
a = 0000 0100

这样，a、b两个变量中的值就进行了对调。

**4)** **"取反"运算**

"取反"运算符 ~ 的作用是将各位数字取反：所有的0置为1，1置为0。例如：

1001 0110 取反后为0110 1001。

**5)** **数据右移**

数据右移操作符 >> 将变量的各位按要求向右移动若干位。右移语句的通常形式是：

variable >>右移位数

如：a = 1111 0000；进行 a = a >> 2 操作后，a = 0011 1100。

**6)** **数据左移**

数据左移操作符 << 将变量的各位按要求向左移动若干位。左移语句的通常形式是：

variable << 左移位数

如：a = 1111 0000；进行 a = a << 2 操作后，a =1100 0000。

无论是左移还是右移，当某位从一端移出时，另一端出现的空白将以从外面移入的0（某些计算机是送1，详细内容请查阅相应C编译程序用户手册）来补充。这说明，移位不同于循环，从一端移出的位并不送回到另一端去，移去的位永远丢失了，同时在另一端只能补上相应位数的0。

移位操作可用于整数的快速乘除运算，左移一位等效于乘2，而右移一位等效于除以2。

如：x = 7， 二进制表达为：0000 0111，

> x << 1 0000 1110，相当于： x =2*7=14，
x << 3 0111 0000，相当于： x=14*2*2*2=112
x << 2 1100 0000， x= 192

在作第三次左移时，其中一位为1的位移到外面去了，而左边只能以0补齐，因而便不等于112*2*2=448，而是等于192了。当x按刚才的步骤反向移动回去时，就不能返回到原来的值了，因为左边丢掉的一个1，再也不能找回来了：

> x >> 2 0011 0000， x=48
x >> 3 0000 0110 x=48/8=6
x >> 1 0000 0011 x=6/2=3

移位操作还可以配合其它位操作夫对寄存器或者数据I/O接口的各个位进行设置、检测，具体方法见下一节。

**2.** **位操作符的一些实用方法介绍**

**1)** **学会应用复合运算符**

如前面所介绍的，位操作运算符可以和赋值运算符"="一起组成复合运算符。即如下5个：

> <

其中，x << = y，相当于x = x << y；

> x >> = y，相当于x = x >> y；
x & = y， 相当于x = x & y；
x ^ = y， 相当于x = x ^ y；
x | = y， 相当于x = x | y；

学会在C语言中使用复合运算符，可以简化源程序，优化目标程序。

**2) C** **语言中一些常见的位操作方法**

由于我们此处学习C 语言的目的主要是为了开发微控制器的控制程序，为此我们特别关注一下对MPU的寄存器、I/O中某一位的操作语句。假如要对PORTA(端口A)的某些位进行赋值、置0、置1、取反、测试，可能会用到如一下一些语句：

① PORTA = 0x87

给整个PORTA赋值，作用是将1000 0111这个数赋予PORTA，即让PORTA的第0、1、2和7位置1，其它位清0。

② PORTA = (1<
