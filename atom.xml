<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Godvmxi Blog</title>
  
  <subtitle>Ball Virtual Blog | 蛋种的博客</subtitle>
  <link href="http://vball.fun/atom.xml" rel="self"/>
  
  <link href="http://vball.fun/"/>
  <updated>2022-10-28T09:05:09.829Z</updated>
  <id>http://vball.fun/</id>
  
  <author>
    <name>Bright Jiang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>移民总结-新加坡</title>
    <link href="http://vball.fun/2022/10/28/imm-sg-01/"/>
    <id>http://vball.fun/2022/10/28/imm-sg-01/</id>
    <published>2022-10-28T09:05:09.829Z</published>
    <updated>2022-10-28T09:05:09.829Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#%E4%BF%AE%E6%94%B9%E6%97%A5%E5%BF%97">修改日志</a></li><li><a href="#%E8%B7%91%E8%B7%AF%E6%96%B0%E5%8A%A0%E5%9D%A1%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9">跑路新加坡的优缺点</a><ul><li><a href="#%E4%BC%98%E7%82%B9">优点</a></li><li><a href="#%E7%BC%BA%E7%82%B9">缺点</a></li></ul></li><li><a href="#%E7%AD%BE%E8%AF%81%E7%B1%BB%E5%9E%8B">签证类型</a></li><li><a href="#%E5%B7%A5%E8%B5%84%E5%92%8C%E6%88%90%E6%9C%AC">工资和成本</a><ul><li><a href="#%E5%B7%A5%E8%B5%84">工资</a></li><li><a href="#%E7%94%9F%E6%B4%BB%E6%88%90%E6%9C%AC">生活成本</a><ul><li><a href="#%E6%88%BF%E7%A7%9F">房租</a></li><li><a href="#%E9%A5%AE%E9%A3%9F">饮食</a></li></ul></li></ul></li><li><a href="#%E6%89%BE%E5%B7%A5%E4%BD%9C">找工作</a><ul><li><a href="#%E6%89%BE%E5%B7%A5%E4%BD%9C%E7%9A%84%E7%B2%BE%E9%AB%93">找工作的精髓</a></li><li><a href="#mycareersfuture">mycareersfuture</a></li><li><a href="#indeed">indeed</a></li><li><a href="#linkden">linkden</a></li><li><a href="#%E7%A9%B7%E4%BA%BA%E7%A9%B7%E7%8E%A9%E6%B3%95">穷人穷玩法</a><ul><li><a href="#%E7%8B%AE%E5%9F%8E%E8%AE%BA%E5%9D%9B">狮城论坛</a></li><li><a href="#%E4%B8%AD%E4%BB%8B%E5%8F%AF%E4%BB%A5%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1">中介可以提供的服务</a></li><li><a href="#%E7%A9%B7%E4%BA%BA%E8%B7%91%E8%B7%AF%E8%81%8C%E4%B8%9A%E7%B1%BB%E5%9E%8B">穷人跑路职业类型</a></li></ul></li></ul></li><li><a href="#%E5%85%B6%E4%BB%96%E5%A4%A7%E4%BD%AC%E7%9A%84%E4%BB%8B%E7%BB%8D%E7%BD%91%E7%AB%99">其他大佬的介绍网站</a></li><li><a href="#%E5%8F%91%E7%8E%B0%E6%9C%89%E9%94%99%E8%AF%AF%E6%88%96%E8%80%85%E9%81%97%E6%BC%8F%E7%9A%84%E5%8F%AF%E4%BB%A5%E7%95%99%E8%A8%80%E6%88%91%E4%BC%9A%E5%A2%9E%E8%A1%A5">发现有错误或者遗漏的可以留言，我会增补</a></li></ul><!-- tocstop --><h1><span id="修改日志">修改日志</span></h1><ul><li><p>2022&#x2F;10&#x2F;28 初稿</p><h1><span id="跑路新加坡的优缺点">跑路新加坡的优缺点</span></h1><p>这编文章的目的是简要介绍，给你各种可以搜索的关键词。 </p><h2><span id="优点">优点</span></h2></li><li><p>穷人屌丝也有机会润， 1万人民币你敢信</p></li><li><p>华语环境，不学英语也能过得滋润</p></li><li><p>发达国家，人文素养很高，工资也高</p></li><li><p>距离近，没有时差，以前据说1500往返飞中国</p></li><li><p>居住条件亚洲前列，不过最近房价上天了，组屋还是不错的</p></li><li><p>英联邦最佳跳板</p></li><li><p>淘宝无缝衔接</p></li><li><p>医疗社会福利，老人福利相对于其他英联邦较差</p></li><li><p>体育设施密度高，特别是游泳馆，很多小区都有</p></li></ul><h2><span id="缺点">缺点</span></h2><ul><li>不准说缺点</li><li>地方小，世界尽头到世界尽头30公里</li><li>贵，相对大陆，什么都贵，不过有淘宝弥补</li><li>房租被润的华人抬上天了，只能住的偏僻</li><li>教育资源本地人优先</li></ul><h1><span id="签证类型">签证类型</span></h1><p>精力有限，这里只是说穷人有关的签证了</p><ol><li>EP<ul><li>工资有要求</li><li>学历有要求</li><li>无配额限制</li><li>可以给家人申请DP，一家人整整齐齐</li><li>半年后可以申请PR</li></ul></li><li>SP<ul><li>大专以上</li><li>一定时间后可以申请PR</li></ul></li><li>WP<ul><li>建筑\制造\港口\服务业劳工，司机</li><li>无学历要求</li></ul></li><li>DP<ul><li>家属，孩子，一家人整整齐齐</li><li>担保人薪水需达到6000新币以上</li></ul></li><li>LTVP（长期探访准证-Long Term Visit Pass）<ul><li>PR\公民的老人</li><li>PR配偶</li><li>担保人工资有要求</li></ul></li></ol><p>签证类型和工资行业等挂钩，大家可以自己评估一下： </p><p><a href="https://www.mom.gov.sg/eservices/services/employment-s-pass-self-assessment-tool">Employment &#x2F; S Pass Self-Assessment Tool (SAT)</a><br><a href="https://zhuanlan.zhihu.com/p/440259784">新加坡签证类型及申请条件</a><br><a href="https://anjiasg.com/blog/types-of-work-visa-in-singapore/">新加坡签证种类都有哪些</a></p><h1><span id="工资和成本">工资和成本</span></h1><h2><span id="工资">工资</span></h2><p>这里都说的工作签证，有PR的大佬们请忽视。</p><table><thead><tr><th>类目</th><th>工资&#x2F;新币</th><th>准证类型</th></tr></thead><tbody><tr><td>码农</td><td>7000-12000+</td><td>EP</td></tr><tr><td>设计师</td><td>4000-7000+</td><td>SP&#x2F;EP</td></tr><tr><td>教师</td><td>3000+</td><td>SP&#x2F;EP</td></tr><tr><td>建筑\制造\港口劳工</td><td>2000-3000</td><td>SP&#x2F;WP</td></tr><tr><td>美容按摩</td><td>2500-3500</td><td>SP&#x2F;WP</td></tr><tr><td>厨房后厨</td><td>2000-3000</td><td>WP</td></tr><tr><td>司机</td><td>2500-4500</td><td>WP</td></tr></tbody></table><h2><span id="生活成本">生活成本</span></h2><p>李家坡生活成本之高，不是吹的，不顾仁者见仁了</p><h3><span id="房租">房租</span></h3><table><thead><tr><th>类目</th><th>价格新币</th><th>面积平方米</th><th>备注</th></tr></thead><tbody><tr><td>次卧</td><td>800-1200</td><td>12-20</td><td>1-2人</td></tr><tr><td>主卧</td><td>1000-1500</td><td>20-30</td><td>2-3人</td></tr><tr><td>整套</td><td>2500-4000</td><td>70-100</td><td>最多可以给6个人办理地址证明</td></tr><tr><td>工地</td><td>—</td><td>—</td><td>—</td></tr></tbody></table><h3><span id="饮食">饮食</span></h3><p>一个人一个月400-600吧，自己做饭的另说</p><h1><span id="找工作">找工作</span></h1><h3><span id="找工作的精髓">找工作的精髓</span></h3><ol><li>顺藤摸瓜</li><li>找猎头</li></ol><pre class="mermaid">graph LR    Seek("搜索工作")    Jobs("目标工作")    InfoC("公司名称")    InfoWeb("公司网站")    InfoWebH("公司招聘网站")    InfoCHr("HR邮箱")    InfoHt("猎头邮箱")    InfoHtC("猎头公司")    InfoHtCWeb("猎头公司网站")    InfoHtCWebH("猎头招聘网站")    SendResume("投简历")    Seek --> Jobs    Jobs  -.-> InfoC    Jobs  -.->  InfoHt     Jobs  -.->  InfoHtC    InfoHtC -.-> InfoHtCWeb    InfoHtCWeb -.-> InfoHt    InfoC -.-> InfoWeb    InfoWeb -.-> InfoCHr    InfoWeb -.-> InfoWebH    InfoHtCWeb -.-> InfoHtCWebH    InfoCHr  --> SendResume    InfoWebH  --> SendResume    InfoHt  --> SendResume    InfoHtCWebH  --> SendResume</pre><h3><span id="mycareersfuture">mycareersfuture</span></h3><p>新加披政府招聘网站，所以可能进行海外招聘的工作都大概率在上边公示。</p><p><a href="https://www.mycareersfuture.gov.sg/">mycareersfuture</a></p><h3><span id="indeed">indeed</span></h3><p>indeed各国都适用(<a href="https://sg.indeed.com/">https://sg.indeed.com/</a>)</p><h3><span id="linkden">linkden</span></h3><p><a href="https://sg.linkedin.com/">领英嘛，记得翻墙使用 </a></p><h3><span id="穷人穷玩法">穷人穷玩法</span></h3><h4><span id="狮城论坛">狮城论坛</span></h4><p>我不清楚哪个是原装哪个是假货了。  </p><p>注意中介骗子挺多，不过不重要，信息的渠道很关键，完事开头难。</p><ul><li><a href="https://bbs.sgcn.com/forum-1255-1.html">狮城论坛-sgcn.com</a></li><li><a href="https://www.shichengbbs.com/c47">狮城论坛-shichengbbs..com</a></li><li><a href="https://www.gongzuo.sg/">狮城论坛-gongzuo.sg</a></li></ul><p>新加坡中介收費一般是5000RMB， 国内外中介会抬高到10000左右，太高就想想吧。  </p><h4><span id="中介可以提供的服务">中介可以提供的服务</span></h4><ul><li>办理护照的证明资料</li><li>工作签证办理的全套手续</li></ul><h4><span id="穷人跑路职业类型">穷人跑路职业类型</span></h4><p><img src="/2022/10/28/imm-sg-01/jobs.jpg"></p><h1><span id="其他大佬的介绍网站">其他大佬的介绍网站</span></h1><p><a href="https://run2.sg/">润去新加坡 <strong>https://run2.sg</strong></a></p><h1><span id="发现有错误或者遗漏的可以留言我会增补">发现有错误或者遗漏的可以留言，我会增补</span></h1>]]></content>
    
    
      
      
    <summary type="html">&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%E4%BF%AE%E6%94%B9%E6%97%A5%E5%BF%97&quot;&gt;修改日志&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%E8%B7%91%E8%B7%AF%E6%96%B0%E5%8A%A0%E5%9</summary>
      
    
    
    
    
    <category term="移民" scheme="http://vball.fun/tags/%E7%A7%BB%E6%B0%91/"/>
    
    <category term="签证" scheme="http://vball.fun/tags/%E7%AD%BE%E8%AF%81/"/>
    
    <category term="新加坡" scheme="http://vball.fun/tags/%E6%96%B0%E5%8A%A0%E5%9D%A1/"/>
    
  </entry>
  
  <entry>
    <title>git checkout PR</title>
    <link href="http://vball.fun/2022/09/30/git-checkout-PR/"/>
    <id>http://vball.fun/2022/09/30/git-checkout-PR/</id>
    <published>2022-09-30T02:51:30.000Z</published>
    <updated>2022-10-28T09:05:09.829Z</updated>
    
    <content type="html"><![CDATA[<p>How to checkout a git pull request using step-by-step instructions.</p><h1><span id="get-your-pr-number">Get your pr number</span></h1><p>You PR number is : <strong>19</strong><br><img src="/2022/09/30/git-checkout-PR/pr_id.png"></p><h1><span id="checkout-your-pr-change-to-local">Checkout your PR change to local</span></h1><p>There are two ways to checkout a PR change</p><h2><span id="use-git">Use git</span></h2><h4><span id="fetch-pr-to-local-pr-branch">Fetch pr to local pr branch</span></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin pull/<span class="number">19</span>/head:local-test-pr-branch</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="checkout-the-local-pr-branch">Checkout the local pr branch</span></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b local-test-pr-branch</span><br></pre></td></tr></table></figure><h2><span id="use-github-cli">Use Github Cli</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gh pr checkout <span class="number">19</span></span><br></pre></td></tr></table></figure><p>full usage: </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gh pr checkout &#123;&lt;number&gt; | &lt;url&gt; | &lt;branch&gt;&#125; [flags]</span><br></pre></td></tr></table></figure><p><a href="https://cli.github.com/manual/gh_pr_checkout">Github Cli Doc</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;How to checkout a git pull request using step-by-step instructions.&lt;/p&gt;
&lt;h1&gt;&lt;span id=&quot;get-your-pr-number&quot;&gt;Get your pr number&lt;/span&gt;&lt;/h1&gt;&lt;</summary>
      
    
    
    
    
    <category term="git" scheme="http://vball.fun/tags/git/"/>
    
    <category term="PR" scheme="http://vball.fun/tags/PR/"/>
    
    <category term="github" scheme="http://vball.fun/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>hexo post import local img error since hexo update</title>
    <link href="http://vball.fun/2022/05/21/hexo-post-import-img-error/"/>
    <id>http://vball.fun/2022/05/21/hexo-post-import-img-error/</id>
    <published>2022-05-21T06:16:54.000Z</published>
    <updated>2022-10-28T09:05:09.829Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="error-happen-in-hexo-asset-image">error happen in hexo-asset-image</span></h1><p>I accepted some PR from the github about the hexo, then the image can not displayed since that..</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">all the image <span class="built_in">link</span> updated to a error <span class="built_in">link</span> <span class="string">&quot;: /.io//02/08/&quot;</span></span><br></pre></td></tr></table></figure><h1><span id="hexo-insert-local-image-in-markdown">Hexo insert local image in markdown</span></h1><h2><span id="enable-assert">enable assert</span></h2><p>update _config.yml of hexo</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">post_asset_folder: <span class="literal">true</span></span><br></pre></td></tr></table></figure><h1><span id="install-plugin">install plugin</span></h1><p>Execute commands in the Hexo directory. <strong>hexo-asset-img</strong>, Do not use <strong>hexo-asset-image</strong>, it’s too old and there is nobody to update it and merge PR.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-asset-img --save</span><br></pre></td></tr></table></figure><p><a href="https://github.com/yiyungent/hexo-asset-img">hexo-asset-img</a></p><p>if you want to Typora to show image correctly, refer <a href="https://moeci.com/posts/hexo-typora/">LINK</a></p><h1><span id="delete-your-hexo-asset-image-in-your-packagejson">delete your <strong>hexo-asset-image</strong> in your package.json</span></h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;error-happen-in-hexo-asset-image&quot;&gt;error happen in hexo-asset-image&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;I accepted some PR from the github about the </summary>
      
    
    
    
    
    <category term="hexo" scheme="http://vball.fun/tags/hexo/"/>
    
    <category term="error" scheme="http://vball.fun/tags/error/"/>
    
  </entry>
  
  <entry>
    <title>使用git管理日记，安利笔记工具gitnote，Zettel</title>
    <link href="http://vball.fun/2022/05/21/write-note-with-git-cn/"/>
    <id>http://vball.fun/2022/05/21/write-note-with-git-cn/</id>
    <published>2022-05-21T04:36:51.000Z</published>
    <updated>2022-10-28T09:05:09.837Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="背景">背景</span></h1><p>日常有太多需要收藏的笔记、待办事项、读书笔记，但不是面临各种意外情况</p><ul><li>本地保存：换电脑或者电脑崩溃你就要和你的工作说再见了</li><li>云存储：除非你用墙外服务区貌似安全，但是身在中国大陆，别说云存储，连你都说没有就没有了</li><li>专业笔记软件，还是身在大陆，敏感词慢慢的就把你的文章动态清零了，一段时候后，你都看不懂<strong>口死比尔</strong>的内容啥意思了<ul><li>印象笔记：纯国产软件，不付费都不让用了，并且分享审核有要死，我珍藏的笔记就那么没了。</li><li>为知笔记：国内国外两个版本，弃用原因如上</li><li>OneNote: 巨硬和党国合作如此紧密，你放心就好</li></ul></li></ul><h1><span id="安利pc端编辑器gitnote">安利PC端编辑器gitnote</span></h1><p>官方主站： <a href="https://gitnoteapp.com/zh/">gitnoteapp</a>, <a href="https://zhaopeng.me/">作者博客</a>, 他的优点：</p><ul><li>跨平台，win,mac,linux</li><li>富文本和markdown语法支持</li><li>基于git的版本管理</li><li>支持自动同步到远端，基于https协议</li><li>支持思维导图（基于插件）</li><li>支持流程图（基于插件）</li><li>支持图片嵌入git管理（基于插件）</li><li>更多插件</li></ul><p>缺点：</p><ul><li>不开源，可能是基于收入什么的，理解，不过一个人实在是精力有限啊。</li><li>拖更很久了。。。</li></ul><p>等作者在更新一版，我就把这个文章优化下，然后翻译成外文，让外边的人也知道，这个世界上好软件也挺多的</p><h2><span id="markdown编辑器">markdown编辑器</span></h2><p><img src="/2022/05/21/write-note-with-git-cn/gitnote_markdown.png" alt="alt"></p><h2><span id="流程图">流程图</span></h2><p><img src="/2022/05/21/write-note-with-git-cn/gitnote_flow.png" alt="alt"></p><h2><span id="思维导图">思维导图</span></h2><p><img src="/2022/05/21/write-note-with-git-cn/gitnote_mind.png" alt="alt"></p><h1><span id="初始化使用">初始化使用</span></h1><h2><span id="github账号注册跳过">github账号注册跳过</span></h2><p><a href="https://www.github.com/">github</a></p><h2><span id="新建存放日记的repo">新建存放日记的repo</span></h2><h3><span id="修改默认的分支为master">修改默认的分支为master</span></h3><p>讨厌白左政治正确，搞得软件也不好用<br><img src="/2022/05/21/write-note-with-git-cn/github_change_master.png"></p><h3><span id="新建代码库repo存放未来的日记">新建代码库repo，存放未来的日记</span></h3><p>貌似私有的会有bug，暂时用公共的吧，有隐私需求的孩子，可以试试gitlab或者放在其他地方。</p><p><img src="/2022/05/21/write-note-with-git-cn/github_new_repo.png"><br><img src="/2022/05/21/write-note-with-git-cn/github_new_repo2.png"></p><h3><span id="获取日记的地址">获取日记的地址</span></h3><p><img src="/2022/05/21/write-note-with-git-cn/github_new_repo3.png"><br><img src="/2022/05/21/write-note-with-git-cn/github_new_repo4.png"></p><h3><span id="获取登录token">获取登录token</span></h3><p>右上角用户头像-&gt; settings -&gt; Developer settings -&gt; Personal access tokens  -&gt; generate new token -&gt; 全部勾选算了 -&gt; generate token<br><img src="/2022/05/21/write-note-with-git-cn/github_token.png"><br>复制这个token，就是你的下边需要的密码</p><h3><span id="回到软件克隆刚才新建的仓库">回到软件,克隆刚才新建的仓库</span></h3><p>设置成功后，重启就可以使用<br><img src="/2022/05/21/write-note-with-git-cn/gitnote_clone.png"></p><h2><span id="日记使用">日记使用</span></h2><h3><span id="markdown语法提示">markdown语法提示</span></h3><p><img src="/2022/05/21/write-note-with-git-cn/gitnote_helper.png"></p><h2><span id="常见问题">常见问题</span></h2><p><a href="https://zhaopeng.me/index.php/archives/gitnote-install-plugin.html">gitnote 手动插件安装</a><br><a href="https://www.zhaopeng.me/index.php/archives/gitnote-github-issue-1.html">GitNote 无法和GitHub 同步问题1</a><br><a href="https://zhaopeng.me/index.php/archives/gitnote-install-plugin.html">gitnote 手动插件安装</a></p><h1><span id="安利内容可以跳过">安利内容,可以跳过</span></h1><h2><span id="markdown">Markdown</span></h2><p>Markdown 是一种轻量级标记语言，它允许人们使用易读易写的纯文本格式编写文档，然后转换成有效的 XHTML（或者HTML）文档。 一句话，用纯文本写你的格式化文档，不用担心word乱码之类的问题，并且随时可以导出word，html，pdf都多种格式。</p><h2><span id="git">Git</span></h2><p>Git是码农最爱，跟踪自己的修改，可以本地，并且可以结合文件协议随时和远端代码库进行同步，包含你能想到的所有存储协议了。</p><h2><span id="github">Github</span></h2><p>这个只是git库的互联网托管服务，类似的服务多如牛毛，并且你随时可以把你的本地存储迁移到任意其他服务商。gitlab，google code. 并且他们基本都可以提供静态网页服务，也就是说，你写完对应的文章后，他就给你生成静态网页了。</p><h2><span id="大陆服务商">大陆服务商</span></h2><p>没有没有，不要拿国产的<strong>gitee</strong>来说事，分化开源社区之类的高大上的理由就不说了，直接说他垃圾就行了，不服提交给代码试试。效果绝对超过<strong>口死比尔</strong></p><p><img src="/2022/05/21/write-note-with-git-cn/gitee_shit.jpg" alt="alt"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;背景&quot;&gt;背景&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;日常有太多需要收藏的笔记、待办事项、读书笔记，但不是面临各种意外情况&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;本地保存：换电脑或者电脑崩溃你就要和你的工作说再见了&lt;/li&gt;
&lt;li&gt;云存储：除非你用墙外服务区貌似安全，但是身</summary>
      
    
    
    
    
    <category term="Note" scheme="http://vball.fun/tags/Note/"/>
    
    <category term="Git" scheme="http://vball.fun/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>ubuntu18 install vnc server and start xfce</title>
    <link href="http://vball.fun/2022/01/29/ubuntu18-install-vnc/"/>
    <id>http://vball.fun/2022/01/29/ubuntu18-install-vnc/</id>
    <published>2022-01-29T02:16:44.000Z</published>
    <updated>2022-10-28T09:05:09.833Z</updated>
    
    <content type="html"><![CDATA[<p>核心两块： xfc4 and vnc4server</p><h1><span id="code-talk">code talk</span></h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install xfce4* vnc4server</span><br></pre></td></tr></table></figure><h1><span id="setup-xstart">setup xstart</span></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ cat ~/.vnc/xstartup </span><br><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">xrdb $HOME/.Xresources</span><br><span class="line">unset SESSION_MANAGER</span><br><span class="line">unset DBUS_SESSION_BUS_ADDRESS</span><br><span class="line">startxfce4 &amp;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1><span id="add-run-exex-to-xstartup">add run exex to xstartup</span></h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x ~/.vcn/xstartup</span><br></pre></td></tr></table></figure><h1><span id="start-vcn4server">Start vcn4server</span></h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vnc4server </span><br></pre></td></tr></table></figure><h1><span id="enjoy-it">Enjoy it</span></h1>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;核心两块： xfc4 and vnc4server&lt;/p&gt;
&lt;h1&gt;&lt;span id=&quot;code-talk&quot;&gt;code talk&lt;/span&gt;&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;</summary>
      
    
    
    
    
    <category term="Ubuntu" scheme="http://vball.fun/tags/Ubuntu/"/>
    
    <category term="VNC" scheme="http://vball.fun/tags/VNC/"/>
    
  </entry>
  
  <entry>
    <title>ubuntu18.04 安装wine以及添加mono和gecko打开简单.net应用的方法</title>
    <link href="http://vball.fun/2022/01/29/ubuntu18-install-wine-and-font/"/>
    <id>http://vball.fun/2022/01/29/ubuntu18-install-wine-and-font/</id>
    <published>2022-01-29T01:48:30.000Z</published>
    <updated>2022-10-28T09:05:09.833Z</updated>
    
    <content type="html"><![CDATA[<p>考虑到国内网络的内容隔天可能就没有，所以做一个记录吧。<br>转载自： <a href="https://www.cnblogs.com/hfclszs/p/13760531.html">https://www.cnblogs.com/hfclszs/p/13760531.html</a><br>安装wine 但是过程略坑..这里简单说一下总结之后的过程.</p><ol start="2"><li>第一步安装wine相关内容</li></ol><p>查了下有winehq和wine两种. 我认为应该没啥区别. 但是第一次采坑是用的winhq但是爬出坑的用的是 wine.. 所以简单记录一下 wine的过程.</p><ol start="3"><li>ubuntu现在很牛B 都不需要改apt-get的source.list就可以直接安装了.</li></ol><p>安装wine</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install wine64 mono-complete </span><br><span class="line"><span class="comment"># 注意一定不要使用 root用户进行安装.</span></span><br><span class="line"><span class="comment"># 安装mono 用来开启.net应用</span></span><br><span class="line">sudo apt-get install axel</span><br><span class="line"><span class="comment"># 多线程下载。哈哈</span></span><br></pre></td></tr></table></figure><ol start="4"><li>但是安装完之后发现还是不行. 会报错 提示没有 一些gecko进行html的渲染操作.</li></ol><p>百度,google一翻得到的结果是需要安装gecko还有mono的内容. 只能从网上下载.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">wine的地址</span><br><span class="line">http://dl.winehq.org/wine/wine-mono/4.9.4/wine-mono-4.9.4.msi</span><br><span class="line">gecko的地址</span><br><span class="line">http://dl.winehq.org/wine/wine-gecko/2.47/wine_gecko-2.47-x86_64.msi</span><br><span class="line">这里面我被坑的基本上生活不能自理了.</span><br><span class="line">````</span><br><span class="line"></span><br><span class="line">下载完成之后需要放到/home/ubuntu1804/.wine/的目录下面执行安装</span><br><span class="line"></span><br><span class="line">注意一定要是放到 wine相关目录里面不然就是白瞎会报错. 提示</span><br><span class="line"></span><br><span class="line">err:mscoree:LoadLibraryShim error reading registry key <span class="keyword">for</span> installroot</span><br><span class="line">安装命令很简单</span><br><span class="line">```bash</span><br><span class="line">wine   msiexec /i  wine-mono-4.9.4.msi</span><br><span class="line">wine   msiexec /i  wine_gecko-2.47-x86_64.msi</span><br></pre></td></tr></table></figure><p>5.之后就可以了 不过需要改进一下中文乱码的问题等有时间了再看, </p><ol start="6"><li>解决中文显示的问题</li></ol><p>来源:<br><a href="http://blog.sina.com.cn/s/blog_686efeba0102vwtj.html">http://blog.sina.com.cn/s/blog_686efeba0102vwtj.html</a><br>3、设置中文问题</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">先把字体simsun.ttc（在你的windows的安装目录里的font文件夹里找，找不到可以从网上下到） 复制到 /home/你的用户名/.wine/drive_c/windows/fonts 文件夹中，要显示隐藏文件夹按Ctrl+H</span><br><span class="line"></span><br><span class="line">修改注册表，在命令行输入 gedit ~/.wine/system.reg</span><br><span class="line"></span><br><span class="line">找到“[System\\CurrentControlSet\\Hardware Profiles\\Current\\Software\\Fonts]”，将其中的““LogPixels”=dword:00000060”改成 ““LogPixels”=dword:00000070“。</span><br><span class="line"></span><br><span class="line">再找到”[Software\\Microsoft\\Windows NT\\CurrentVersion\\FontSubstitutes] xxxx“项，将其中的”MS Shell Dlg“相关的两项修改成如下内容（即更换字体为宋体）：</span><br><span class="line"></span><br><span class="line">“MS Shell Dlg”=”SimSun”</span><br><span class="line">“MS Shell Dlg 2&amp;Prime;=”SimSun”</span><br><span class="line"></span><br><span class="line">然后：gedit ~/.wine/drive_c/windows/win.ini</span><br><span class="line"></span><br><span class="line">在其中加上（如果没有），有的话修改成如下</span><br><span class="line"></span><br><span class="line">[Desktop]</span><br><span class="line">menufontsize=13</span><br><span class="line">messagefontsize=13</span><br><span class="line">statusfontsize=13</span><br><span class="line">IconTitleSize=13</span><br></pre></td></tr></table></figure><p>现在中文显示应该正常了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;考虑到国内网络的内容隔天可能就没有，所以做一个记录吧。&lt;br&gt;转载自： &lt;a href=&quot;https://www.cnblogs.com/hfclszs/p/13760531.html&quot;&gt;https://www.cnblogs.com/hfclszs/p/13760531.</summary>
      
    
    
    
    
    <category term="Ubuntu" scheme="http://vball.fun/tags/Ubuntu/"/>
    
    <category term="Wine" scheme="http://vball.fun/tags/Wine/"/>
    
    <category term="Mono" scheme="http://vball.fun/tags/Mono/"/>
    
    <category term="Gecko" scheme="http://vball.fun/tags/Gecko/"/>
    
  </entry>
  
  <entry>
    <title>C bit And Big Little Endian</title>
    <link href="http://vball.fun/2021/12/16/c-bit-and-big-little-end/"/>
    <id>http://vball.fun/2021/12/16/c-bit-and-big-little-end/</id>
    <published>2021-12-16T23:30:49.000Z</published>
    <updated>2022-10-28T09:05:09.801Z</updated>
    
    <content type="html"><![CDATA[<p>The tencent engineer asked a question about the C bit, I could not answer it with a pretty description. so there is a summary for it.</p><h1><span id="bit-little-endule">Bit Little Endule</span></h1><p>for exmaple: 32bit int（uint32_t） data : 0x12345678，store in address : 0x08004000:</p><table><thead><tr><th>Address</th><th>Little Endian</th><th>Big Endian</th></tr></thead><tbody><tr><td>0x08004003</td><td>0x12</td><td>0x78</td></tr><tr><td>0x08004002</td><td>0x34</td><td>0x56</td></tr><tr><td>0x08004001</td><td>0x56</td><td>0x34</td></tr><tr><td>0x08004000</td><td>0x78</td><td>0x12</td></tr></tbody></table><h1><span id="cpu">CPU</span></h1><p>little-endian</p><blockquote><p>X86<br>ARM(default)</p></blockquote><p>big-endian</p><blockquote><p>PowerPC<br>IBM</p></blockquote><h2><span id="host-to-network-bit">Host to network bit</span></h2><blockquote><p>htonl()<br>htons()</p></blockquote><h2><span id="network-to-host-bit">Network to host bit</span></h2><blockquote><p>ntohl()<br>ntohs()</p></blockquote><h1><span id="check-big-amp-little-endian">Check Big &amp; Little Endian</span></h1><h2><span id="int-char-check">Int char check</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i = <span class="number">1</span>;   </span><br><span class="line"><span class="type">char</span> *p = (<span class="type">char</span> *)&amp;i;   </span><br><span class="line"><span class="keyword">if</span>(*p == <span class="number">1</span>)     </span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Little Endian&quot;</span>); </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Big Endian&quot;</span>);</span><br></pre></td></tr></table></figure><h2><span id="union-check">union check</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">checkCPUendian</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">union</span></span></span><br><span class="line"><span class="class">  &#123;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> a;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> b; </span><br><span class="line">  &#125;c;</span><br><span class="line">  c.a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> (c.b == <span class="number">1</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1><span id="parse-bit-field">Parse bit field</span></h1><p>We need to parse the data protocal, and there are many key-value in bit mode, usually we will use the right shift to get the target bit.<br><img src="/2021/12/16/c-bit-and-big-little-end/bit.png"></p><blockquote><p>D will be :  ((pucPktAddr + 3)&gt;&gt;6) &amp; 0x3  –point shift 3 bytes, and right shift 6 bit，then apply mask 0x3</p></blockquote><blockquote><p>E will be :  ((pucPktAddr + 3)&gt;&gt;3) &amp; 0x7</p></blockquote><p>Now we try bit mode</p><h1><span id="bit-mode">Bit mode</span></h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">XXX</span> &#123;</span></span><br><span class="line"><span class="number">2</span>     <span class="type">unsigned</span> <span class="type">char</span> D:<span class="number">2</span></span><br><span class="line"><span class="number">3</span>     <span class="type">unsigned</span> <span class="type">char</span> E:<span class="number">3</span></span><br><span class="line"><span class="number">4</span>     <span class="type">unsigned</span> <span class="type">char</span> F:<span class="number">3</span>  </span><br><span class="line"><span class="number">5</span> &#125;</span><br></pre></td></tr></table></figure><p>then we can use xxx-&gt;D，xxx-&gt;E，xxx-&gt;F to access the data，but this is only in big end mode, if you want to use light end mode,try to reverse it:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">XXX</span> &#123;</span></span><br><span class="line"><span class="number">2</span>     <span class="type">unsigned</span> <span class="type">char</span> F:<span class="number">3</span></span><br><span class="line"><span class="number">3</span>     <span class="type">unsigned</span> <span class="type">char</span> E:<span class="number">3</span></span><br><span class="line"><span class="number">4</span>     <span class="type">unsigned</span> <span class="type">char</span> D:<span class="number">2</span>  </span><br><span class="line"><span class="number">5</span> &#125;</span><br></pre></td></tr></table></figure><h1><span id="大小端序数据相互转换函数">大小端序数据相互转换函数</span></h1><h2><span id="将unsigned-char数组转换成大端序整数">将unsigned char数组转换成“大端序”整数；</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*    Function:        ConverseArrayToBeUI</span></span><br><span class="line"><span class="comment">*    Description:    将无符号字符数组数据转换成“大端序”整数</span></span><br><span class="line"><span class="comment">*    Parameter:        srcArray    --[in]    源数组数据</span></span><br><span class="line"><span class="comment">*                    desBeData    --[out]    目标“大端序”整数</span></span><br><span class="line"><span class="comment">*    Return            0    成功</span></span><br><span class="line"><span class="comment">*                    非0    失败</span></span><br><span class="line"><span class="comment">*    Note:            </span></span><br><span class="line"><span class="comment">*    Other:</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> MULCONVERSE_CALL <span class="title function_">ConverseArrayToBeUI</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *srcArray,<span class="type">unsigned</span> <span class="type">int</span> *desBeData)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (srcArray == NULL_POINT || desBeData == NULL_POINT)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ERR_NULL_POINT;</span><br><span class="line">    &#125;</span><br><span class="line">    *desBeData = (<span class="type">unsigned</span> <span class="type">int</span>)(srcArray[<span class="number">0</span>]&lt;&lt;<span class="number">24</span>) + (<span class="type">unsigned</span> <span class="type">int</span>)(srcArray[<span class="number">1</span>]&lt;&lt;<span class="number">16</span>) + </span><br><span class="line">                    (<span class="type">unsigned</span> <span class="type">int</span>)(srcArray[<span class="number">2</span>]&lt;&lt;<span class="number">8</span>) + (<span class="type">unsigned</span> <span class="type">int</span>)srcArray[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">return</span> _SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2><span id="将unsigned-char数组转换成小端序整数">将unsigned char数组转换成“小端序”整数；</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*    Function:        ConverseArrayToLeUI</span></span><br><span class="line"><span class="comment">*    Description:    将无符号字符数组数据转换成“小端序”整数</span></span><br><span class="line"><span class="comment">*    Parameter:        srcArray    --[in]    源数组数据</span></span><br><span class="line"><span class="comment">*                    desLeData    --[out]    目标“小端序”整数</span></span><br><span class="line"><span class="comment">*    Return            0    成功</span></span><br><span class="line"><span class="comment">*                    非0    失败</span></span><br><span class="line"><span class="comment">*    Note:            </span></span><br><span class="line"><span class="comment">*    Other:</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> MULCONVERSE_CALL <span class="title function_">ConverseArrayToLeUI</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *srcArray,<span class="type">unsigned</span> <span class="type">int</span> *desLeData)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (srcArray == NULL_POINT || desLeData == NULL_POINT)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ERR_NULL_POINT;</span><br><span class="line">    &#125;</span><br><span class="line">    *desLeData = (<span class="type">unsigned</span> <span class="type">int</span>)(srcArray[<span class="number">3</span>]&lt;&lt;<span class="number">24</span>) + (<span class="type">unsigned</span> <span class="type">int</span>)(srcArray[<span class="number">2</span>]&lt;&lt;<span class="number">16</span>) + </span><br><span class="line">                    (<span class="type">unsigned</span> <span class="type">int</span>)(srcArray[<span class="number">1</span>]&lt;&lt;<span class="number">8</span>) + (<span class="type">unsigned</span> <span class="type">int</span>)srcArray[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span> _SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2><span id="将整数按照大端序格式存储在数组中">将整数按照“大端序”格式存储在数组中；</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*    Function:        ConverseUItoBeArray</span></span><br><span class="line"><span class="comment">*    Description:    将无符号整数转换成“大端序”存储的无符号字符数组</span></span><br><span class="line"><span class="comment">*    Parameter:        srcData        --[in]    源整数</span></span><br><span class="line"><span class="comment">*                    desBeArray    --[out]    目标“大端序”存储的数组数据</span></span><br><span class="line"><span class="comment">*    Return            0    成功</span></span><br><span class="line"><span class="comment">*                    非0    失败</span></span><br><span class="line"><span class="comment">*    Note:            </span></span><br><span class="line"><span class="comment">*    Other:</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> MULCONVERSE_CALL <span class="title function_">ConverseUItoBeArray</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> srcData,<span class="type">unsigned</span> <span class="type">char</span> *desBeArray)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (desBeArray == NULL_POINT)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ERR_NULL_POINT;</span><br><span class="line">    &#125;</span><br><span class="line">    desBeArray[<span class="number">0</span>] = (<span class="type">unsigned</span> <span class="type">char</span>)(srcData&gt;&gt;<span class="number">24</span>);</span><br><span class="line">    desBeArray[<span class="number">1</span>] = (<span class="type">unsigned</span> <span class="type">char</span>)(srcData&gt;&gt;<span class="number">16</span>);</span><br><span class="line">    desBeArray[<span class="number">2</span>] = (<span class="type">unsigned</span> <span class="type">char</span>)(srcData&gt;&gt;<span class="number">8</span>);</span><br><span class="line">    desBeArray[<span class="number">3</span>] = (<span class="type">unsigned</span> <span class="type">char</span>)srcData;</span><br><span class="line">    <span class="keyword">return</span> _SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2><span id="将整数按照小端序格式存储在数组中">将整数按照“小端序”格式存储在数组中。</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*    Function:        ConverseUItoLeArray</span></span><br><span class="line"><span class="comment">*    Description:    将无符号整数转换成“小端序”存储的无符号字符数组</span></span><br><span class="line"><span class="comment">*    Parameter:        srcData        --[in]    源整数</span></span><br><span class="line"><span class="comment">*                    desLeArray    --[out]    目标“小端序”存储的数组数据</span></span><br><span class="line"><span class="comment">*    Return            0    成功</span></span><br><span class="line"><span class="comment">*                    非0    失败</span></span><br><span class="line"><span class="comment">*    Note:            </span></span><br><span class="line"><span class="comment">*    Other:</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> MULCONVERSE_CALL <span class="title function_">ConverseUItoLeArray</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> srcData,<span class="type">unsigned</span> <span class="type">char</span> *desLeArray)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (desLeArray == NULL_POINT)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ERR_NULL_POINT;</span><br><span class="line">    &#125;</span><br><span class="line">    desLeArray[<span class="number">3</span>] = (<span class="type">unsigned</span> <span class="type">char</span>)(srcData&gt;&gt;<span class="number">24</span>);</span><br><span class="line">    desLeArray[<span class="number">2</span>] = (<span class="type">unsigned</span> <span class="type">char</span>)(srcData&gt;&gt;<span class="number">16</span>);</span><br><span class="line">    desLeArray[<span class="number">1</span>] = (<span class="type">unsigned</span> <span class="type">char</span>)(srcData&gt;&gt;<span class="number">8</span>);</span><br><span class="line">    desLeArray[<span class="number">0</span>] = (<span class="type">unsigned</span> <span class="type">char</span>)srcData;</span><br><span class="line">    <span class="keyword">return</span> _SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2><span id="big-endian-to-little-endian">Big-Endian to Little-Endian</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> BigtoLittle16(A) ((((uint16)(A) &amp; 0xff00) &gt;&gt; 8) | (((uint16)(A) &amp; 0x00ff) &lt;&lt; 8))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BigtoLittle32(A) ((((uint32)(A) &amp; 0xff000000) &gt;&gt; 24) | (((uint32)(A) &amp; 0x00ff0000) &gt;&gt; 8) | \</span></span><br><span class="line"><span class="meta">             (((uint32)(A) &amp; 0x0000ff00) &lt;&lt; 8) | (((uint32)(A) &amp; 0x000000ff) &lt;&lt; 24))</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;The tencent engineer asked a question about the C bit, I could not answer it with a pretty description. so there is a summary for it.&lt;/p&gt;</summary>
      
    
    
    
    
    <category term="C" scheme="http://vball.fun/tags/C/"/>
    
    <category term="Interview" scheme="http://vball.fun/tags/Interview/"/>
    
    <category term="Bit Endian" scheme="http://vball.fun/tags/Bit-Endian/"/>
    
    <category term="Little Endian" scheme="http://vball.fun/tags/Little-Endian/"/>
    
  </entry>
  
  <entry>
    <title>Video Codec Reference Code Summary</title>
    <link href="http://vball.fun/2021/12/16/codec-reference-summary/"/>
    <id>http://vball.fun/2021/12/16/codec-reference-summary/</id>
    <published>2021-12-16T06:52:11.000Z</published>
    <updated>2022-10-28T09:05:09.801Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="code-talk">Code talk</span></h1><p>I summary all main video codecs JM&#x2F;HM to github, you can find in : <a href="https://github.com/godvmxi/codec_refer_code">JM&#x2F;HM</a></p><h1><span id="why-do-this-useless-work">Why do this useless work</span></h1><p>The code can only build in the the legacy GCC, so I modify it to adapt to the modern GCC.</p><h1><span id="jvet-repo">JVET REPO</span></h1><p><a href="https://vcgit.hhi.fraunhofer.de/jvet">JVET REPO</a><br>All the codec reference code has been moved into a gitlab account (JVET), you can find all origin code.<br><img src="/2021/12/16/codec-reference-summary/jvet.png" alt="jvet.png"></p><h1><span id="todo-build-code-on-modern-gnu-gcc">TODO build code on modern GNU GCC</span></h1><p>GCC10 as a standard :</p><ul><li><input checked disabled type="checkbox"> JM build</li><li><input disabled type="checkbox"> HM build</li><li><input disabled type="checkbox"> SVC build</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;code-talk&quot;&gt;Code talk&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;I summary all main video codecs JM&amp;#x2F;HM to github, you can find in : &lt;a href=&quot;https://gi</summary>
      
    
    
    
    
    <category term="H264" scheme="http://vball.fun/tags/H264/"/>
    
    <category term="AVC" scheme="http://vball.fun/tags/AVC/"/>
    
    <category term="HEVC" scheme="http://vball.fun/tags/HEVC/"/>
    
    <category term="SVC" scheme="http://vball.fun/tags/SVC/"/>
    
  </entry>
  
  <entry>
    <title>H264/AVC 编解码器原理总结</title>
    <link href="http://vball.fun/2021/12/16/h264-avc-codec/"/>
    <id>http://vball.fun/2021/12/16/h264-avc-codec/</id>
    <published>2021-12-16T06:41:20.000Z</published>
    <updated>2022-10-28T09:05:09.829Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="h264x2favc的应用">H.264&#x2F;AVC的应用</span></h1><p>H.264 支持三个不同档次：</p><blockquote><p>基本档次：主要用于“视频会话”，如会议电视，可视电话，远程医疗、远程教学等；<br>扩展档次：主要用于网络的视频流，如视频点播；<br>主要档次：主要用于消费电子应用，如数字电视广播，数字视频存储等。</p></blockquote><h1><span id="h264x2favc编解码器">H.264&#x2F;AVC编解码器</span></h1><h2><span id="编码器">编码器</span></h2><p>H.264 编码器的功能组成如下图所示</p><p><img src="/2021/12/16/h264-avc-codec/h264_enc_flow_2.png"><br><img src="/2021/12/16/h264-avc-codec/h264_enc_flow.png"></p><h2><span id="解码器">解码器</span></h2><p>H.264解码器的功能组成如下图所示<br><img src="/2021/12/16/h264-avc-codec/h264_dec_flow.png"></p><h1><span id="h264x2favc的结构">H.264&#x2F;AVC的结构</span></h1><h2><span id="术语">术语</span></h2><h3><span id="场和帧">场和帧</span></h3><p>视频的一场或一帧可用来产生一个编码图像。通常，视频帧可分成两种类型：连续或隔行视频帧。在电视中，为减少大面积闪烁现象，把一帧分成两个隔行的场。显然，这时场内邻行之间的空间相关性较强，而帧内邻近行空间相关性强，因此活动量较小或静止的图像宜采用帧编码方式，对活动量较大的运动图像则宜采用场编码方式。</p><h3><span id="宏块-片">宏块、片</span></h3><p>一个编码图像通常划分成若干宏块组成，一个宏块由一个 16×16 亮度像素和附加的一个 8×8 Cb和一个 8×8 Cr 彩色像素块组成。每个图象中，若干宏块被排列成片的形式。<br>I 片只包含 I 宏块， P 片可包含 P 和 I 宏块，而 B 片可包含 B 和 I 宏块。<br>I 宏块利用从当前片中已解码的像素作为参考进行帧内预测（不能取其它片中的已解码像素作为参考进行帧内预测）。<br>P 宏块利用前面已编码图象作为参考图象进行帧内预测，一个帧内编码的宏块可进一步作宏块的分割：即 16×16、 16×8、 8×16 或 8×8 亮度像素块（以及附带的彩色像素）；如果选了 8×8 的子宏块，则可再分成各种子宏块的分割，其尺寸为 8×8、 8×4、 4×8 或 4×4 亮度像素块（以及附带的彩色像素）。<br>B 宏块则利用双向的参考图象（当前和未来的已编码图象帧）进行帧内预测。</p><h2><span id="档次和级">档次和级</span></h2><p>H.264 规定了三种档次，每个档次支持一组特定的编码功能如下图所示，并支持一类特定的应用。每一档次设置不同参数（如取样速率、图像尺寸、编码比特率等），得到编解码器性能不同的级。<br><img src="/2021/12/16/h264-avc-codec/h264_enc_profile.png"></p><blockquote><p>基本档次：利用 I 片和 P 片支持帧内和帧间编码，支持利用基于上下文的自适应的变长编码进行的熵编码（CAVLC）。主要用于可视电话、会议电视、无线通信等实时视频通信；<br>主要档次：支持隔行视频，采用 B 片的帧间编码和采用加权预测的帧内编码；支持利用基于上下文的自适应的算术编码（CABAC）。主要用于数字广播电视与数字视频存储；<br>扩展档次：支持码流之间有效的切换（SP 和 SI 片）、改进误码性能（数据分割），但不支持隔行视频和 CABAC。展档次包括了基本档次的所有功能，而不能包括主要档次的。</p></blockquote><p><a href="https://www.cnblogs.com/CoderTian/p/8596068.html">REF</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;h264x2favc的应用&quot;&gt;H.264&amp;#x2F;AVC的应用&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;H.264 支持三个不同档次：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;基本档次：主要用于“视频会话”，如会议电视，可视电话，远程医疗、远程教学等；&lt;br&gt;扩</summary>
      
    
    
    
    
    <category term="H264" scheme="http://vball.fun/tags/H264/"/>
    
    <category term="AVC" scheme="http://vball.fun/tags/AVC/"/>
    
  </entry>
  
  <entry>
    <title>CABAC vs CAVLC</title>
    <link href="http://vball.fun/2021/12/16/cabac-cavlc/"/>
    <id>http://vball.fun/2021/12/16/cabac-cavlc/</id>
    <published>2021-12-16T03:54:25.000Z</published>
    <updated>2022-10-28T09:05:09.801Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="什么是熵编码">什么是熵编码？</span></h1><p>熵编码压缩是一种无损压缩，其实现原理是使用新的编码来表示输入的数据，从而达到压缩的效果。常用的熵编码有游程编码，哈夫曼编码和CAVLC编码等。<br>CAVLC是在H.264&#x2F;MPEG-4AVC中使用的熵编码方式。在H.264中，CAVLC以zig-zag顺序用于对变换后的残差块进行编码。CAVLC是CABAC的替代品，虽然其压缩效率不如CABAC，但CAVLC实现简单，并且在所有的H.264profile中都支持。<br><img src="/2021/12/16/cabac-cavlc/flow.png"></p><h1><span id="cabac">CABAC</span></h1><p>CABAC: 基于上下文自适应的二进制算术编码(Context-based Adaptive Binary Arithmetic Coding)</p><h1><span id="cavlc">CAVLC</span></h1><p>CAVLC: 基于上下文自适应变长编码(Context-based Adaptive Variable Length Coding)</p><h1><span id="perf">Perf</span></h1><p>CABAC和CAVLC是H.264中的两种熵编码算法.通过序列foreman和coastguard对CABAC和CAVLC的压缩性能进行了比较,在给定的实验条件下得出CABAC的比特率比CAVLC节省5%～14%,并且随量化步长的增大,比特率节省增多.但是CABAC计算复杂度高,耗时比CAVLC长,</p><h2><span id="cabac编码详情">CABAC编码详情</span></h2><p>CABAC编码之所以能取得很高的压缩比，是因为：</p><blockquote><p>a) 根据每一个语法元素的上下文来选取预测模型;<br>b) 使用本地的统计数据来估计概率；<br>c) 使用算术编码而不是变长编码。</p></blockquote><p>编码一个符号需要经过下面几步：</p><blockquote><ol><li>二值化。CABAC使用的算术编码是基于二进制的算术编码，因此非二进制形式的编码首先要转化为二进制的形式表示。</li><li>选择上下文模型。“上下文模型”是指对二值化后的符号中的bit位进行编码时使用的概率模型。概率模型与最近编码的符号相关，会有多个概率模型可供选择。</li><li>算术编码。算术编码器根据第2步选择的概率模型对每个bit进行编码。需要注意的是每个bit的子范围只有两个数：0和1。</li><li>更新预测模型。根据实际编码的值来更新所选择的预测模型。例如，如果所编码的二进制bit为1,则预测模型中的1计数要增加。</li></ol></blockquote><h2><span id="cavlc的编码过程如下">CAVLC的编码过程如下：</span></h2><h3><span id="1-计算非零系数totalcoeffs和拖尾系数trailingones的数目">1. 计算非零系数（TotalCoeffs）和拖尾系数（TrailingOnes）的数目。</span></h3><p>拖尾系数指值为 +1&#x2F;-1的系数，最大数目为 3。如果超过 3个，那么只有最后三个被视为拖尾系数。拖尾系数的数目被赋值到变量 TrailingOnes。<br>非零系数包括所有的拖尾系数，其数目被赋值到变量 TotalCoeffs)。</p><h3><span id="2-计算ncnumbercurrent当前块值">2. 计算nC(numberCurrent，当前块值)。</span></h3><p>nC值由左边块的非零系数 nA和上面块非零系数 nB来确定，计算公式为： nC&#x3D;round((nA+nB)&#x2F;2)；若 nA存在 nB不存在，则 nC&#x3D;nA；若 nA不存在而 nB存在，则 nC&#x3D;nB；若 nA和 nB都不存在，则 nC&#x3D;0。<br>nC值用于选择 VLC编码表，如下图所示。这里体现了上下文相关 (contextadaptive)的特性，例如当 nC值较小即周围块的非零系数较少时，就会选择比较短的码，从而实现了数据压缩。<br><img src="/2021/12/16/cabac-cavlc/cal_2.gif"></p><h3><span id="3查表获得coff_token的编码">3.查表获得coff_token的编码。</span></h3><p>根据之前编码和计算过程所得的变量 TotalCoeffs 、 TrailingOnes 和 nC 值可以查 H.264 标准附录 CAVLC 码表，即可得出 coeff_token 编码序列。</p><h3><span id="4-编码每个拖尾系数的符号按zig-zag的逆序进行编码">4. 编码每个拖尾系数的符号，按zig-zag的逆序进行编码。</span></h3><p>每个符号用 1个 bit位来表示， 0表示“ +”， 1表示“—”。<br>当拖尾系数超过三个时只有最后三个被认定为拖尾系数，引词编码顺序为从后向前编码。</p><h3><span id="5-编码除拖尾系数之外非零系数的levellevels">5. 编码除拖尾系数之外非零系数的level（Levels）。</span></h3><p>每个非零系数的 level包括 sign和 magnitude，扫描顺序是逆 zig-zag序。<br>level的编码由前缀 (level_prefix)和后缀 (level_suffix)组成。前缀的长度在 0到 6之间，后缀的长度则可通过下面的步骤来确定：<br>将后缀初始化为 0。（若非零系数的总数超过 10且拖尾系数不到 3，则初始化为 1）。<br>编码频率最高（即按扫描序最后）的除拖尾系数之外的非零系数。<br>若这个系数的 magnitude 超过某个门槛值 (threshold) ，则增加后缀的长度。下表是门槛值的列表：<br><img src="/2021/12/16/cabac-cavlc/cal_5.gif"></p><h3><span id="6-编码最后一个非零系数之前0的个数totalzeos">6. 编码最后一个非零系数之前0的个数（totalZeos）。</span></h3><p>TotalZeros 指的是在最后一个非零系数前零的数目，此非零系数指的是按照正向扫描的最后一个非零系数<br>根据 TotalCoeffs 值， H.264 标准共提供了 25 个变长表格供查找，其中编码亮度数据时有 15 个表格供查找，编码色度 DC2 × 2 块（ 4 ： 2:0 格式）有 3 个表格、编码色度 DC2 × 4 块（ 4 ： 2:2 格式）有 7 个表格。</p><h3><span id="7-编码每个系数前面0的数目run_before">7. 编码每个系数前面0的数目（run_before）。</span></h3><p>扫描顺序为 zig-zag 的逆序。<br>若 ∑ [run_before]&#x3D;&#x3D; total_zeros ，则不需再计算run_before<br>扫描序中的最后一个元素不需要计算 run_before<br>每个 run_before 的 VLC 编码取决于 run_before 自身及未编码的 0 的个数 ZerosLeft 。例如若 ZerosLeft&#x3D;&#x3D; 2 ，那么 run_before 只可能是 0,1 或 2 ，因此使用两个 bit 即可表示。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;什么是熵编码&quot;&gt;什么是熵编码？&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;熵编码压缩是一种无损压缩，其实现原理是使用新的编码来表示输入的数据，从而达到压缩的效果。常用的熵编码有游程编码，哈夫曼编码和CAVLC编码等。&lt;br&gt;CAVLC是在H.264&amp;#x2F;MPE</summary>
      
    
    
    
    
    <category term="H264" scheme="http://vball.fun/tags/H264/"/>
    
    <category term="AVC" scheme="http://vball.fun/tags/AVC/"/>
    
  </entry>
  
  <entry>
    <title>Force Download View Only Video From Microsoft Sharepoint / Streams</title>
    <link href="http://vball.fun/2021/12/10/download-view-only-video-from-microsoft-sharepoint/"/>
    <id>http://vball.fun/2021/12/10/download-view-only-video-from-microsoft-sharepoint/</id>
    <published>2021-12-10T06:06:45.000Z</published>
    <updated>2022-10-28T09:05:09.805Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="background">Background</span></h1><p>There are some many teams meeting records shared by other teams, but only be available for 21 days, view only but no download. Hate it. &amp;#x1F643;&amp;#x1F928;</p><h1><span id="talk-is-cheap-show-me-the-code">Talk is cheap, show me the code.</span></h1><h2><span id="force-downlaod-from-share-point">Force downlaod from Share Point</span></h2><p>Chrome&#x2F;Edge(F12) -&gt; Inspector -&gt; Network -&gt; <strong>videomanifest?privode</strong></p><ol><li><p>Open the Sharepoint page with the video you want to download</p></li><li><p>Press F12 or Ctrl + Shift + C on your keyboard to open the browser inspector. (Cmd + Option + C on Mac OS X)</p></li><li><p>In the top part, click on the Network tab</p></li><li><p>In the top left part - right below the Network tab - you should see a field with the word “Filter” inside it. Click it to gain focus and type: <code>videomanifest</code></p></li><li><p>Refresh the Sharepoint page</p></li><li><p>After a few seconds you should now see 1 result in the browser inspector’s network part. That should be something looking like:<br>videomanifest?provider&#x3D;spo… &#x3D;&gt; that right there is the manifest URL you will need later on. Right-click on it and copy the link address.</p></li><li><p>Use ffmpeg to download the video.</p></li></ol><p><img src="/2021/12/10/download-view-only-video-from-microsoft-sharepoint/sharepoint_inspection.png" alt="inspection"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i <span class="string">&quot;https://theURLtoTheManifestYouCopiedHere&quot;</span> -codec copy downloadedVideo.mp4</span><br></pre></td></tr></table></figure><h2><span id="force-downlaod-from-stream">Force downlaod from Stream</span></h2><p>Get <a href="https://github.com/snobu/destreamer">destreamer</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/snobu/destreamer</span><br><span class="line">$ <span class="built_in">cd</span> destreamer</span><br><span class="line">$ npm install</span><br><span class="line">$ npm run build</span><br></pre></td></tr></table></figure><h3><span id="download-a-video">Download a video</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./destreamer.sh -i <span class="string">&quot;https://web.microsoftstream.com/video/VIDEO-1&quot;</span></span><br></pre></td></tr></table></figure><h3><span id="download-a-video-and-re-encode-with-hevc">Download a video and re-encode with HEVC</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./destreamer.sh -i <span class="string">&quot;https://web.microsoftstream.com/video/VIDEO-1&quot;</span> --vcodec libx265</span><br></pre></td></tr></table></figure><h3><span id="download-many-videos-but-read-urls-from-a-file-">Download many videos but read URLs from a file -</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./destreamer.sh -f list.txt</span><br></pre></td></tr></table></figure><h3><span id="you-can-get-more-usage-from-the-origin-code-repo">You can get more usage from the origin code repo</span></h3><p>Enjoy it.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;background&quot;&gt;Background&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;There are some many teams meeting records shared by other teams, but only be available fo</summary>
      
    
    
    
    
    <category term="Ffmpeg" scheme="http://vball.fun/tags/Ffmpeg/"/>
    
    <category term="Microsoft" scheme="http://vball.fun/tags/Microsoft/"/>
    
    <category term="Sharepoint" scheme="http://vball.fun/tags/Sharepoint/"/>
    
  </entry>
  
  <entry>
    <title>Best Practice Of Vscode</title>
    <link href="http://vball.fun/2021/12/09/best-practice-on-vscode/"/>
    <id>http://vball.fun/2021/12/09/best-practice-on-vscode/</id>
    <published>2021-12-09T03:29:50.000Z</published>
    <updated>2022-10-28T09:05:09.801Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="plugin">Plugin</span></h1><h2><span id="english-grammar-check">English grammar check</span></h2><table><thead><tr><th>name</th><th>description</th><th>more</th></tr></thead><tbody><tr><td>Grammarly</td><td>grammar checking</td><td></td></tr></tbody></table><h3><span id="jump-tools">Jump Tools</span></h3><table><thead><tr><th>name</th><th>description</th><th>more</th></tr></thead><tbody><tr><td>Bookmarks</td><td>easy jump in bookmarks</td><td></td></tr></tbody></table><h3><span id="code-format">Code Format</span></h3><table><thead><tr><th>name</th><th>description</th><th>more</th></tr></thead><tbody><tr><td>Trailing Spaces</td><td>remove space</td><td></td></tr></tbody></table><h3><span id="markdown">Markdown</span></h3><table><thead><tr><th>name</th><th>description</th><th>more</th></tr></thead><tbody><tr><td>Markdown Preview Markmap Support</td><td>markdown preview</td><td></td></tr><tr><td>Markdown Preview Mermaid Support</td><td>mermaid flow draw</td><td></td></tr><tr><td>Mermaid Export</td><td>mermaid png export</td><td></td></tr></tbody></table><h3><span id="fun">Fun</span></h3><table><thead><tr><th>name</th><th>description</th><th>more</th></tr></thead><tbody><tr><td>Power Mode</td><td>Make Screen screaming and set your coding on fire</td><td></td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;plugin&quot;&gt;Plugin&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span id=&quot;english-grammar-check&quot;&gt;English grammar check&lt;/span&gt;&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;name&lt;</summary>
      
    
    
    
    
    <category term="Vscode" scheme="http://vball.fun/tags/Vscode/"/>
    
    <category term="Plugin" scheme="http://vball.fun/tags/Plugin/"/>
    
    <category term="Grammar" scheme="http://vball.fun/tags/Grammar/"/>
    
  </entry>
  
  <entry>
    <title>Automatic Release With Github Actions</title>
    <link href="http://vball.fun/2021/12/09/auto-release-with-github-actions/"/>
    <id>http://vball.fun/2021/12/09/auto-release-with-github-actions/</id>
    <published>2021-12-09T03:12:10.000Z</published>
    <updated>2022-10-28T09:05:09.801Z</updated>
    
    <content type="html"><![CDATA[<h2><span id="brief">Brief</span></h2><p>Based on my last auto release for my blog, I am considering to release my snap package to the release page automatically.</p><h2><span id="talk-is-cheap-show-me-the-code">Talk is cheap. Show me the code.</span></h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Publish</span> <span class="string">Release</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">tags:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;v*&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build_7yuv_snap:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-18.04</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Check</span> <span class="string">out</span> <span class="string">Git</span> <span class="string">repository</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">Snapcraft</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">samuelmeuli/action-snapcraft@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">use_lxd:</span> <span class="literal">true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">Snap</span> <span class="string">package</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          sg lxd -c &#x27;snapcraft --use-lxd&#x27;</span></span><br><span class="line"><span class="string">          ls -lah</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">&quot;marvinpinto/action-automatic-releases@latest&quot;</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">repo_token:</span> <span class="string">&quot;$<span class="template-variable">&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;</span>&quot;</span></span><br><span class="line">          <span class="attr">automatic_release_tag:</span> <span class="string">&quot;latest&quot;</span></span><br><span class="line">          <span class="attr">prerelease:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">title:</span> <span class="string">&quot;Development Build&quot;</span></span><br><span class="line">          <span class="attr">files:</span> <span class="string">|</span></span><br><span class="line">            <span class="string">*.snap</span></span><br></pre></td></tr></table></figure><h2><span id="release-contents">Release contents</span></h2><p>It will package the whole source package based on new tag, and if you want to package other files, use the files flag:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">files:</span> <span class="string">|</span></span><br><span class="line">  <span class="string">*.snap</span></span><br></pre></td></tr></table></figure><h2><span id="github_token">GITHUB_TOKEN</span></h2><p>you can generate it in your personal token page and fill it in the secret pages. so cheap and skip.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2&gt;&lt;span id=&quot;brief&quot;&gt;Brief&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;Based on my last auto release for my blog, I am considering to release my snap package to the relea</summary>
      
    
    
    
    
    <category term="Github actions" scheme="http://vball.fun/tags/Github-actions/"/>
    
    <category term="Yaml" scheme="http://vball.fun/tags/Yaml/"/>
    
    <category term="Automatic" scheme="http://vball.fun/tags/Automatic/"/>
    
  </entry>
  
  <entry>
    <title>Switch to Github Actions and F Travis CI</title>
    <link href="http://vball.fun/2021/12/08/use-github-actions-push-blog/"/>
    <id>http://vball.fun/2021/12/08/use-github-actions-push-blog/</id>
    <published>2021-12-08T07:43:07.000Z</published>
    <updated>2022-10-28T09:05:09.833Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="fxxk-travis-ci-stopped-generating-my-page">Fxxk Travis Ci stopped generating my page</span></h1><p>One day, After I updated some blog and there was no update on my Github page blog, then I checked the Travis-CI, it showed <strong>Builds have been temporarily disabled for public repositories</strong><br><img src="/2021/12/08/use-github-actions-push-blog/travis_down.png" alt="Down"><br>Then, whatever, F it. I spent more than 2 hours setting up my Credit Card to activate the Travis-CI service, and now It just down and without any notifications.</p><h1><span id="back-to-github-actions">Back to GitHub actions</span></h1><p>Luckily, Github provides the workflows with actions.</p><pre class="mermaid">sequenceDiagramparticipant LA as Localparticipant RM as Repo Master Branchparticipant RP as Repo gh-pages Branchparticipant GA as Github ActionsLA ->> LA: hexo new pageLA ->> LA: hexo s, setup preview serverLA ->> LA: http://127.0.0.1:4000 previewLA --> LA: add github actions workflow yamlLA ->> RM: Push to MasterRM ->> GA: Trigger actionsGA ->> GA: Setup nodeGA ->> GA: Install packageGA ->> GA: Generate static blog pageGA ->> RP: Push to Repo publish branch</pre><h2><span id="github-workflow-yaml-setting">Github workflow yaml setting</span></h2><p>Code talks firstly</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This workflow will do a clean install of</span></span><br><span class="line"><span class="comment"># node dependencies, cache/restore them,</span></span><br><span class="line"><span class="comment"># build the source code and run tests across different versions of node</span></span><br><span class="line"><span class="comment"># For more information see:</span></span><br><span class="line"><span class="comment"># https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Node.js</span> <span class="string">CI</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Node</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;14&#x27;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Env</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm install -g hexo-cli@4.0.0</span></span><br><span class="line"><span class="string">          npm install</span></span><br><span class="line"><span class="string">          hexo generate</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">peaceiris/actions-gh-pages@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">deploy_key:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.HEXO_DEPLOY_PRI</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">publish_dir:</span> <span class="string">./public</span></span><br><span class="line">          <span class="attr">publish_branch:</span> <span class="string">gh_pages</span>  <span class="comment"># deploying branch</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1><span id="workflow-detail">Workflow detail</span></h1><h2><span id="setup-basic-node-based-on-ubuntu">Setup basic Node based on ubuntu</span></h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Node</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;14&#x27;</span></span><br></pre></td></tr></table></figure><h2><span id="install-hexo-to-ci-system-and-build">Install hexo to CI system and build</span></h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Env</span></span><br><span class="line">  <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">    <span class="string">npm</span> <span class="string">install</span> <span class="string">-g</span> <span class="string">hexo-cli@4.0.0</span></span><br></pre></td></tr></table></figure><p>if we do not install this version globally, then the CI will not find the hexo command.</p><h2><span id="install-other-packages-and-generate-the-static-page">Install other packages and generate the static page</span></h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">npm</span> <span class="string">install</span></span><br><span class="line"><span class="string">hexo</span> <span class="string">generate</span></span><br></pre></td></tr></table></figure><h2><span id="deploy-to-repo-gh-pages-branch-with-deploy-tools">Deploy to Repo gh-pages branch with deploy tools</span></h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">  <span class="attr">uses:</span> <span class="string">peaceiris/actions-gh-pages@v3</span></span><br><span class="line">  <span class="attr">with:</span></span><br><span class="line">    <span class="attr">deploy_key:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.HEXO_DEPLOY_PRI</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="attr">publish_dir:</span> <span class="string">./public</span></span><br><span class="line">    <span class="attr">publish_branch:</span> <span class="string">gh_pages</span>  <span class="comment"># deploying branch</span></span><br></pre></td></tr></table></figure><p>It will deploy your Ci public directory to your repo gh_pages branch.</p><h2><span id="actions-related-resource">Actions Related Resource</span></h2><p>If you need more help, just <a href="https://github.com/marketplace/actions/github-pages-action">peaceiris&#x2F;actions-gh-pages@v3</a> pages for more help.</p><h3><span id="this-actions-support-many-tokens">This actions support many tokens</span></h3><p><img src="/2021/12/08/use-github-actions-push-blog/tokens.png" alt="Tokens"></p><p>If you just need https, choose github_token, and if you prefer to ssh, you can use deploy_key(it’s my style)</p><h2><span id="last-do-not-forget-to-update-your-page-setting-to-your-gh-pages-branch">Last, DO NOT forget to update your page setting to your gh-pages branch</span></h2><p><img src="/2021/12/08/use-github-actions-push-blog/gh_pages.png" alt="Page"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;fxxk-travis-ci-stopped-generating-my-page&quot;&gt;Fxxk Travis Ci stopped generating my page&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;One day, After I updated so</summary>
      
    
    
    
    
    <category term="Github" scheme="http://vball.fun/tags/Github/"/>
    
    <category term="Actions" scheme="http://vball.fun/tags/Actions/"/>
    
  </entry>
  
  <entry>
    <title>pynput stop key echo in bash</title>
    <link href="http://vball.fun/2021/12/07/pynput-stop-echo-in-bash/"/>
    <id>http://vball.fun/2021/12/07/pynput-stop-echo-in-bash/</id>
    <published>2021-12-07T09:16:18.000Z</published>
    <updated>2022-10-28T09:05:09.829Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="optional-descriptions">Optional descriptions</span></h1><ol><li>optionally block propagation of keyboard events</li><li>python block key events</li><li>python listen to keyboards and stop the event message</li></ol><h1><span id="code-talk-first">Code talk first</span></h1><p>set suppress&#x3D;True will swallow. ALL keypresses</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> pynput.keyboard <span class="keyword">import</span> Key, Listener</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_press</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#123;0&#125; pressed&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">        key))</span><br><span class="line">    <span class="keyword">if</span> key == Key.esc:</span><br><span class="line">        <span class="comment"># Stop listener</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Collect events until released</span></span><br><span class="line"><span class="keyword">with</span> Listener(</span><br><span class="line">        on_press=on_press, suppress=<span class="literal">True</span>) <span class="keyword">as</span> listener:</span><br><span class="line">    listener.join()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1><span id="issue">Issue</span></h1><p>When use pynput to capture keyboard input like this:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> Listener(</span><br><span class="line">        on_press=on_press) <span class="keyword">as</span> listener:</span><br><span class="line">    listener.join()</span><br></pre></td></tr></table></figure><p>the terminal will auto echo the key info, even special echo for up&#x2F;down , such as:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ python3 key_listener.py </span><br><span class="line">Key.up pressed</span><br><span class="line">^[[AKey.right pressed</span><br><span class="line">^[[CKey.left pressed</span><br><span class="line">^[[DKey.down pressed</span><br><span class="line">^[[BKey.right pressed</span><br><span class="line">^[[CKey.left pressed</span><br><span class="line">^[[DKey.up pressed</span><br><span class="line">^[[A<span class="string">&#x27;a&#x27;</span> pressed</span><br><span class="line">a<span class="string">&#x27;s&#x27;</span> pressed</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Now the world is slient and clean.</p><h1><span id="note">NOTE</span></h1><p>but if you forget to exit the app, other apps will never get a valid key input forever.</p><h1><span id="you-can-also-just-read-input-from-stdinuse-get_char-to-do-it">You can also just read input from stdin,use get_char to do it</span></h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;optional-descriptions&quot;&gt;Optional descriptions&lt;/span&gt;&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;optionally block propagation of keyboard events&lt;/li&gt;
&lt;li&gt;pyth</summary>
      
    
    
    
    
    <category term="Python" scheme="http://vball.fun/tags/Python/"/>
    
    <category term="pynput" scheme="http://vball.fun/tags/pynput/"/>
    
  </entry>
  
  <entry>
    <title>build 7yuv snap package, run 7yuv in no-qt4 system</title>
    <link href="http://vball.fun/2021/11/23/build-7yuv-snap-package/"/>
    <id>http://vball.fun/2021/11/23/build-7yuv-snap-package/</id>
    <published>2021-11-23T07:00:53.000Z</published>
    <updated>2022-10-28T09:05:09.801Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#7yuv">7YUV</a></li><li><a href="#about-snap">About Snap</a></li><li><a href="#my-snap-build-file-for-7yuv">My snap build file for 7yuv</a></li><li><a href="#snap-build-instructions">Snap build instructions</a><ul><li><a href="#snap-base">snap base</a></li><li><a href="#build-plugin">build plugin</a></li><li><a href="#add-qt4-runtime-to-snap">add Qt4 runtime to snap</a></li><li><a href="#add-dbus-and-slot">Add dbus and slot</a></li></ul></li><li><a href="#manual-build-snap-from-code">manual build snap from code</a><ul><li><a href="#i-will-ignore-steps-about-installing-snap-and-snapcrash">I will ignore steps about installing snap and snapcrash</a></li><li><a href="#build-snap-package-with-lxd">build snap package – with lxd</a></li><li><a href="#install-your-snap">Install your snap</a></li></ul></li></ul><!-- tocstop --><h1><span id="7yuv">7YUV</span></h1><p>As a video software developer, 7yuv is a nice YUV sequence analysis tool(Of course, Vooya is another good option), but the developer of 7YUV does not punish the Qt5 version and the latest Linux system has removed the support of Qt4. So I chose to build a snap package for 7yuv to make sure it can works well in any snap supported system. </p><h1><span id="about-snap">About Snap</span></h1><p>Snaps are app packages for desktop, cloud and IoT that are easy to install, secure, cross‐platform and dependency‐free. Snaps are discoverable and installable from the Snap Store, the app store for Linux with an audience of millions.</p><h1><span id="my-snap-build-file-for-7yuv">My snap build file for 7yuv</span></h1><p>You can find my full code in <a href="https://github.com/godvmxi/7yuv_snap_wrap">LINK</a></p><h1><span id="snap-build-instructions">Snap build instructions</span></h1><h2><span id="snap-base">snap base</span></h2><p>The qt4 is still support on snap core18, so I choose the core18 as the base system</p><h2><span id="build-plugin">build plugin</span></h2><p>I have the raw 7yuv binnary, so I choose the dump plugin to install the 7yuv to my snap packge, the plugin will install all source dirtory to the system and keep the origin directory layout.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">parts:</span><br><span class="line">  7yuv:</span><br><span class="line">    <span class="comment"># See &#x27;snapcraft plugins&#x27;</span></span><br><span class="line">    plugin: dump</span><br><span class="line">    <span class="built_in">source</span>: 7yuv-2.5_x64_pre_build/</span><br></pre></td></tr></table></figure><h2><span id="add-qt4-runtime-to-snap">add Qt4 runtime to snap</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">parts:</span><br><span class="line">  7yuv:</span><br><span class="line">------------</span><br><span class="line">    stage-packages:</span><br><span class="line">      - libqtcore4</span><br><span class="line">      - libqtgui4</span><br><span class="line">      - libstdc++6</span><br><span class="line">      - libqt4-opengl</span><br><span class="line">      - libalglib3.11</span><br><span class="line">      - libgcc1</span><br><span class="line">      - libgl1</span><br><span class="line">      - libgl1-mesa-glx</span><br><span class="line">      - libgl2ps1.4</span><br><span class="line">      - libglu1</span><br><span class="line">      - libglu1-mesa</span><br><span class="line">      - libgsl23</span><br><span class="line">      - libgslcblas0</span><br><span class="line">      - libmuparser2v5</span><br><span class="line">      - libqt4-network</span><br><span class="line">      - libqt4-qt3support</span><br><span class="line">      - libqt4-svg</span><br><span class="line">      - libqt4-xml</span><br><span class="line">      - libqtassistantclient4</span><br><span class="line">      - libqtexengine1</span><br><span class="line">      - libtamuanova-0.2</span><br><span class="line">      - zlib1g</span><br><span class="line">      - sip-api-12.3</span><br></pre></td></tr></table></figure><h2><span id="add-dbus-and-slot">Add dbus and slot</span></h2><p>Do not ask why, I do not know, you can check the snap doc for it.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">slots:</span><br><span class="line">  dbus-daemon:</span><br><span class="line">    interface: dbus</span><br><span class="line">    bus: session</span><br><span class="line">    name: de.datahammer.7yuv</span><br><span class="line"></span><br><span class="line">plugs:</span><br><span class="line">  config-7yuv:</span><br><span class="line">    interface: system-files</span><br><span class="line">    <span class="built_in">read</span>:</span><br><span class="line">      - /</span><br><span class="line">    write:</span><br><span class="line">      - /</span><br></pre></td></tr></table></figure><h1><span id="manual-build-snap-from-code">manual build snap from code</span></h1><h2><span id="i-will-ignore-steps-about-installing-snap-and-snapcrash">I will ignore steps about installing snap and snapcrash</span></h2><h2><span id="build-snap-package-with-lxd">build snap package – with lxd</span></h2><p>I use the lxd to replace the multpass, the multipass has a lot trouble in ubuntu20, so I give up it.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snapcraft --debug --use-lxd</span><br></pre></td></tr></table></figure><p>you will find the target snap file in build directory.</p><h2><span id="install-your-snap">Install your snap</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snap install --devmode --dangerous   7yuv_0.1_amd64.snap</span><br></pre></td></tr></table></figure><p>Now you can run 7yuv from any snap system</p>]]></content>
    
    
      
      
    <summary type="html">&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#7yuv&quot;&gt;7YUV&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#about-snap&quot;&gt;About Snap&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#my-snap-build-file-for-7yuv</summary>
      
    
    
    
    
    <category term="7yuv" scheme="http://vball.fun/tags/7yuv/"/>
    
    <category term="Snap" scheme="http://vball.fun/tags/Snap/"/>
    
    <category term="Qt4" scheme="http://vball.fun/tags/Qt4/"/>
    
    <category term="Ubuntu" scheme="http://vball.fun/tags/Ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>add watermarker to bitstream tool</title>
    <link href="http://vball.fun/2021/11/16/add-watermarker-to-h264-tool/"/>
    <id>http://vball.fun/2021/11/16/add-watermarker-to-h264-tool/</id>
    <published>2021-11-16T07:58:29.000Z</published>
    <updated>2022-10-28T09:05:09.797Z</updated>
    
    <content type="html"><![CDATA[<p>Index:</p><!-- toc --><ul><li><a href="#usage">Usage</a><ul><li><a href="#read-and-write-bitstream-by-frames-with-opencv2">read and write bitstream by frames with opencv2</a></li><li><a href="#use-freetype-to-render-the-string-and-add-to-frame">use freetype to render the string and add to frame</a></li><li><a href="#show-new-frame-with-opencv2">Show new frame with opencv2</a></li><li><a href="#font-load-note">font load note</a></li></ul></li><li><a href="#usage-guide">Usage Guide</a><ul><li><a href="#code-help">Code Help:</a></li><li><a href="#basic-usage">Basic Usage:</a></li><li><a href="#advanced-usage">Advanced Usage:</a></li><li><a href="#parameters-guide">Parameters Guide</a></li></ul></li><li><a href="#talk-is-cheap-show-me-the-code">Talk is cheap, show me the code</a></li></ul><!-- tocstop --><h2><span id="usage">Usage</span></h2><p>In daily test, I need to add number watermarker to the bitstream, then dump it to different yuv formats.</p><h3><span id="read-and-write-bitstream-by-frames-with-opencv2">read and write bitstream by frames with opencv2</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">cap = cv2.VideoCapture(args.<span class="built_in">input</span>)</span><br><span class="line">total_frames = <span class="built_in">int</span>( cap.get(cv2.CAP_PROP_FRAME_COUNT) )</span><br><span class="line">input_width = <span class="built_in">int</span>(cap.get(<span class="number">3</span>))</span><br><span class="line">input_height = <span class="built_in">int</span>(cap.get(<span class="number">4</span>))</span><br><span class="line">video_info = <span class="string">&#x27;video : &#123;0&#125;x&#123;1&#125; frames:&#123;2&#125;&#x27;</span>.<span class="built_in">format</span>(input_width, input_height, total_frames)</span><br><span class="line"><span class="built_in">print</span>(video_info)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;total frames :&quot;</span>, total_frames)</span><br><span class="line"></span><br><span class="line">fourcc = cv2.VideoWriter_fourcc(*<span class="string">&#x27;X264&#x27;</span>)</span><br><span class="line">video_output = cv2.VideoWriter(args.output, fourcc, <span class="number">30.0</span>, (input_width, input_height))</span><br><span class="line"><span class="keyword">if</span> args.frame_number &gt; <span class="number">0</span> <span class="keyword">and</span> args.frame_number &lt; total_frames:</span><br><span class="line">    total_frames = args.frame_number</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;processing frame number is : &quot;</span>, total_frames)</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(total_frames):</span><br><span class="line">    <span class="comment"># set frame position</span></span><br><span class="line">    <span class="comment">#cap.set(cv2.CAP_PROP_POS_FRAMES,index)</span></span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">    marker_text = <span class="string">&#x27;&#123;0&#125;&#123;1:0&gt;2&#125;&#x27;</span>.<span class="built_in">format</span>(args.prefix, index)</span><br><span class="line">    add_watermark_to_frame(frame, marker_text,args.text_height, (args.offset_x, args.offset_y))</span><br><span class="line">    video_output.write(frame)</span><br><span class="line">    <span class="keyword">if</span> args.show:</span><br><span class="line">        cv2.imshow(<span class="string">&quot;Video&quot;</span>, frame)</span><br><span class="line">        <span class="keyword">if</span> cv2.waitKey(<span class="number">5000</span>) &amp; <span class="number">0xFF</span> == <span class="built_in">ord</span>(<span class="string">&#x27;q&#x27;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">cap.release()</span><br><span class="line">video_output.release()</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure><h3><span id="use-freetype-to-render-the-string-and-add-to-frame">use freetype to render the string and add to frame</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_watermark_to_frame</span>(<span class="params">frame, txt, text_height,offset</span>):</span><br><span class="line">    ft = cv2.freetype.createFreeType2()</span><br><span class="line">    ft.loadFontData(fontFileName=<span class="string">&#x27;UbuntuMono-Regular.ttf&#x27;</span>,</span><br><span class="line">                    <span class="built_in">id</span>=<span class="number">0</span>)</span><br><span class="line">    ft_size, baseline= ft.getTextSize(txt, text_height, -<span class="number">1</span>)</span><br><span class="line">    <span class="comment">#print(&quot;Msg: &#123;0&#125; &#123;1&#125; dat: &#123;2&#125;&quot;.format(ft_size, baseline, txt))</span></span><br><span class="line">    magin_pixel = <span class="number">5</span></span><br><span class="line">    rectangle_start = (offset[<span class="number">0</span>] + baseline - magin_pixel, offset[<span class="number">1</span>] - ft_size[<span class="number">1</span>] - baseline - magin_pixel )</span><br><span class="line">    rectangle_end = (offset[<span class="number">0</span>] + ft_size[<span class="number">0</span>] + magin_pixel ,  offset[<span class="number">1</span>] + baseline + magin_pixel) <span class="comment">#</span></span><br><span class="line">    <span class="comment">#print(&quot;start: &#123;0&#125; -&gt; end: &#123;1&#125;&quot;.format(rectangle_start, rectangle_end))</span></span><br><span class="line">    cv2.rectangle(frame,</span><br><span class="line">        rectangle_start,</span><br><span class="line">        rectangle_end,</span><br><span class="line">        (<span class="number">250</span>,<span class="number">240</span>,<span class="number">240</span>),</span><br><span class="line">        -<span class="number">1</span></span><br><span class="line">        )</span><br><span class="line">    ft.putText(img=frame,</span><br><span class="line">            text=txt,</span><br><span class="line">            org=(offset[<span class="number">0</span>], offset[<span class="number">1</span>]),</span><br><span class="line">            fontHeight=text_height,</span><br><span class="line">            color=(<span class="number">255</span>,  <span class="number">10</span>, <span class="number">10</span>),</span><br><span class="line">            thickness=-<span class="number">1</span>,</span><br><span class="line">            line_type=cv2.LINE_AA,</span><br><span class="line">            bottomLeftOrigin=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> frame</span><br></pre></td></tr></table></figure><h3><span id="show-new-frame-with-opencv2">Show new frame with opencv2</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cv2.imshow(<span class="string">&quot;Video&quot;</span>, frame)</span><br></pre></td></tr></table></figure><h3><span id="font-load-note">font load note</span></h3><ol><li>the code will auto load “UbuntuMono-Regular.ttf” to render the picture with freetype, please put this font to the script dir</li><li>the code need opencv2 support, install it by yourself</li></ol><h2><span id="usage-guide">Usage Guide</span></h2><h3><span id="code-help">Code Help:</span></h3><p><img src="/2021/11/16/add-watermarker-to-h264-tool/image2021-4-26_16-44-37.png" alt="usage"></p><h3><span id="basic-usage">Basic Usage:</span></h3><p>It will get first 10 frames and add number watermarker in each frame, then save to output.mp4 file.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 cv_watermark.py -i origin.mp4 -o output.mp4 -n 10</span><br></pre></td></tr></table></figure><p><img src="/2021/11/16/add-watermarker-to-h264-tool/image2021-4-26_16-48-17.png" alt="usage"></p><h3><span id="advanced-usage">Advanced Usage:</span></h3><p>It will get first 10 frames and add number watermarker in each frame, then save to output.mp4 file.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 ./cv_watermark.py -i Mix_BostonHarbor_MainStreet_GrandBendPatio_1920x1088.mp4  -prefix  <span class="string">&quot;AMD is awesome: &quot;</span>  -s</span><br></pre></td></tr></table></figure><p><img src="/2021/11/16/add-watermarker-to-h264-tool/image2021-4-26_17-15-37.png" alt="usage"></p><h3><span id="parameters-guide">Parameters Guide</span></h3><table><thead><tr><th>parameter</th><th>description</th></tr></thead><tbody><tr><td>test</td><td>tset</td></tr><tr><td>i</td><td>input bitstream file name</td></tr><tr><td>n</td><td>frame number</td></tr><tr><td>o</td><td>output bitstream file name</td></tr><tr><td>ox</td><td>watermarker offset x in target bitstream</td></tr><tr><td>oy</td><td>watermarker offset y in target bitstream</td></tr><tr><td>prefix</td><td>prefix info in front of the number watermarker</td></tr><tr><td>s</td><td>show the picture frame by frame, q: exit ; space : next frame</td></tr><tr><td>th</td><td>watermarker text height</td></tr></tbody></table><h2><span id="talk-is-cheap-show-me-the-code">Talk is cheap, show me the code</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess <span class="keyword">as</span> sp</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line">args = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_args_parse</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(<span class="string">&#x27;传入参数：***.py&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-iw&#x27;</span>,<span class="string">&#x27;--width&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">1920</span>, <span class="built_in">help</span>=<span class="string">&quot;input frame width&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-ih&#x27;</span>,<span class="string">&#x27;--height&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">1088</span>, <span class="built_in">help</span>=<span class="string">&quot;input frame height&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-ox&#x27;</span>,<span class="string">&#x27;--offset_x&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">64</span>, <span class="built_in">help</span>=<span class="string">&quot;watermark start offset x&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-oy&#x27;</span>,<span class="string">&#x27;--offset_y&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">128</span>, <span class="built_in">help</span>=<span class="string">&quot;watermark start offset y&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-i&#x27;</span>,<span class="string">&#x27;--input&#x27;</span>, default=<span class="string">&quot;input.yuv&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>,<span class="string">&#x27;--output&#x27;</span>, default=<span class="string">&quot;out.yuv&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-th&#x27;</span>,<span class="string">&#x27;--text_height&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">100</span>, <span class="built_in">help</span>=<span class="string">&quot;watermark text height&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-prefix&#x27;</span>,<span class="string">&#x27;--prefix&#x27;</span>, default=<span class="string">&quot;&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;watermarker prefix, such as AMD-0&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-s&#x27;</span>,<span class="string">&#x27;--show&#x27;</span>,<span class="built_in">help</span>=<span class="string">&quot;show image one by one&quot;</span>, action=<span class="string">&quot;store_true&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-n&#x27;</span>,<span class="string">&#x27;--frame_number&#x27;</span>,<span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">0</span>,<span class="built_in">help</span>=<span class="string">&quot;handle n frames&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> parser</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_watermark_to_frame</span>(<span class="params">frame, txt, text_height,offset</span>):</span><br><span class="line">    ft = cv2.freetype.createFreeType2()</span><br><span class="line">    ft.loadFontData(fontFileName=<span class="string">&#x27;UbuntuMono-Regular.ttf&#x27;</span>,</span><br><span class="line">                    <span class="built_in">id</span>=<span class="number">0</span>)</span><br><span class="line">    ft_size, baseline= ft.getTextSize(txt, text_height, -<span class="number">1</span>)</span><br><span class="line">    <span class="comment">#print(&quot;Msg: &#123;0&#125; &#123;1&#125; dat: &#123;2&#125;&quot;.format(ft_size, baseline, txt))</span></span><br><span class="line">    magin_pixel = <span class="number">5</span></span><br><span class="line">    rectangle_start = (offset[<span class="number">0</span>] + baseline - magin_pixel, offset[<span class="number">1</span>] - ft_size[<span class="number">1</span>] - baseline - magin_pixel )</span><br><span class="line">    rectangle_end = (offset[<span class="number">0</span>] + ft_size[<span class="number">0</span>] + magin_pixel ,  offset[<span class="number">1</span>] + baseline + magin_pixel) <span class="comment">#</span></span><br><span class="line">    <span class="comment">#print(&quot;start: &#123;0&#125; -&gt; end: &#123;1&#125;&quot;.format(rectangle_start, rectangle_end))</span></span><br><span class="line">    cv2.rectangle(frame,</span><br><span class="line">        rectangle_start,</span><br><span class="line">        rectangle_end,</span><br><span class="line">        (<span class="number">250</span>,<span class="number">240</span>,<span class="number">240</span>),</span><br><span class="line">        -<span class="number">1</span></span><br><span class="line">        )</span><br><span class="line">    ft.putText(img=frame,</span><br><span class="line">            text=txt,</span><br><span class="line">            org=(offset[<span class="number">0</span>], offset[<span class="number">1</span>]),</span><br><span class="line">            fontHeight=text_height,</span><br><span class="line">            color=(<span class="number">255</span>,  <span class="number">10</span>, <span class="number">10</span>),</span><br><span class="line">            thickness=-<span class="number">1</span>,</span><br><span class="line">            line_type=cv2.LINE_AA,</span><br><span class="line">            bottomLeftOrigin=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> frame</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    args = get_args_parse().parse_args()</span><br><span class="line">    <span class="built_in">print</span>(args)</span><br><span class="line">    <span class="built_in">print</span>(args.width)</span><br><span class="line">    <span class="comment">#get_watermark(&quot;temp&quot;)</span></span><br><span class="line">    cap = cv2.VideoCapture(args.<span class="built_in">input</span>)</span><br><span class="line">    total_frames = <span class="built_in">int</span>( cap.get(cv2.CAP_PROP_FRAME_COUNT) )</span><br><span class="line">    input_width = <span class="built_in">int</span>(cap.get(<span class="number">3</span>))</span><br><span class="line">    input_height = <span class="built_in">int</span>(cap.get(<span class="number">4</span>))</span><br><span class="line">    video_info = <span class="string">&#x27;video : &#123;0&#125;x&#123;1&#125; frames:&#123;2&#125;&#x27;</span>.<span class="built_in">format</span>(input_width, input_height, total_frames)</span><br><span class="line">    <span class="built_in">print</span>(video_info)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;total frames :&quot;</span>, total_frames)</span><br><span class="line"></span><br><span class="line">    fourcc = cv2.VideoWriter_fourcc(*<span class="string">&#x27;X264&#x27;</span>)</span><br><span class="line">    video_output = cv2.VideoWriter(args.output, fourcc, <span class="number">30.0</span>, (input_width, input_height))</span><br><span class="line">    <span class="keyword">if</span> args.frame_number &gt; <span class="number">0</span> <span class="keyword">and</span> args.frame_number &lt; total_frames:</span><br><span class="line">        total_frames = args.frame_number</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;processing frame number is : &quot;</span>, total_frames)</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(total_frames):</span><br><span class="line">        <span class="comment"># set frame position</span></span><br><span class="line">        <span class="comment">#cap.set(cv2.CAP_PROP_POS_FRAMES,index)</span></span><br><span class="line">        ret, frame = cap.read()</span><br><span class="line">        marker_text = <span class="string">&#x27;&#123;0&#125;&#123;1:0&gt;2&#125;&#x27;</span>.<span class="built_in">format</span>(args.prefix, index)</span><br><span class="line">        add_watermark_to_frame(frame, marker_text,args.text_height, (args.offset_x, args.offset_y))</span><br><span class="line">        video_output.write(frame)</span><br><span class="line">        <span class="keyword">if</span> args.show:</span><br><span class="line">            cv2.imshow(<span class="string">&quot;Video&quot;</span>, frame)</span><br><span class="line">            <span class="keyword">if</span> cv2.waitKey(<span class="number">5000</span>) &amp; <span class="number">0xFF</span> == <span class="built_in">ord</span>(<span class="string">&#x27;q&#x27;</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    cap.release()</span><br><span class="line">    video_output.release()</span><br><span class="line">    cv2.destroyAllWindows()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Index:&lt;/p&gt;
&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#usage&quot;&gt;Usage&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#read-and-write-bitstream-by-frames-with-opencv2&quot;&gt;read and </summary>
      
    
    
    
    
    <category term="Python" scheme="http://vball.fun/tags/Python/"/>
    
    <category term="Opencv" scheme="http://vball.fun/tags/Opencv/"/>
    
    <category term="Freetype" scheme="http://vball.fun/tags/Freetype/"/>
    
    <category term="Font" scheme="http://vball.fun/tags/Font/"/>
    
  </entry>
  
  <entry>
    <title>generate different yuv in different formats</title>
    <link href="http://vball.fun/2021/11/16/ffmpeg-generate-yuv-format/"/>
    <id>http://vball.fun/2021/11/16/ffmpeg-generate-yuv-format/</id>
    <published>2021-11-16T07:44:02.000Z</published>
    <updated>2022-10-28T09:05:09.805Z</updated>
    
    <content type="html"><![CDATA[<p>Index:</p><!-- toc --><ul><li><a href="#ffmpeg-convet-basic-usage">FFMPEG convet basic usage</a><ul><li><a href="#show-all-support-formats-by-ffmpeg">Show all support formats by ffmpeg</a></li><li><a href="#ffmpeg-convert-mp4-to-yuv-with-resolution-and-format">FFMPEG convert mp4 to yuv with resolution and format</a></li><li><a href="#convert-yuv-to-h264mp4">Convert yuv to H264&#x2F;mp4</a></li></ul></li><li><a href="#how-to-generate-rgb444-fp16-file">How to generate RGB444 FP16 file</a><ul><li><a href="#install-ffmpeg-and-imagemagick">Install ffmpeg and imagemagick.</a></li><li><a href="#first-convert-the-image-to-rgb-format-from-yuv420">First convert the image to RGB format from YUV420.</a></li><li><a href="#convert-more-formats">Convert more formats</a></li><li><a href="#display-the-rgba-fp16-image">Display the RGBA FP16 image</a></li></ul></li><li><a href="#my-work-flow-to-generate-custom-yuv-formats">My work flow to generate custom yuv formats</a></li><li><a href="#yuv-view-tools">YUV view tools</a></li></ul><!-- tocstop --><p>ffmpeg can be used to generate many kinds of format. just enum it and record it.</p><h1><span id="ffmpeg-convet-basic-usage">FFMPEG convet basic usage</span></h1><h2><span id="show-all-support-formats-by-ffmpeg">Show all support formats by ffmpeg</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -pix_fmts</span><br></pre></td></tr></table></figure><p>use “-pix_fmt “ to define the output formats in ffmpeg</p><table><thead><tr><th>name</th><th>format</th><th>bit depth</th><th>Note</th></tr></thead><tbody><tr><td>yuv420p</td><td>YUV420</td><td>8</td><td>NV12</td></tr><tr><td>yuv420p16le</td><td>YUV420</td><td>10</td><td>P0101?</td></tr><tr><td>yuv444p</td><td>YUV444</td><td>8</td><td></td></tr><tr><td>yuv444p10le</td><td>YUV444</td><td>10</td><td></td></tr></tbody></table><h2><span id="ffmpeg-convert-mp4-to-yuv-with-resolution-and-format">FFMPEG convert mp4 to yuv with resolution and format</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -y -i <span class="variable">$&#123;file_name&#125;</span>_<span class="variable">$&#123;in_res&#125;</span>.mp4 -pix_fmt yuv420p -s <span class="variable">$out_res</span> <span class="variable">$&#123;file_name&#125;</span>_<span class="variable">$&#123;out_res&#125;</span>.yuv</span><br></pre></td></tr></table></figure><h2><span id="convert-yuv-to-h264x2fmp4">Convert yuv to H264&#x2F;mp4</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -f rawvideo -pix_fmt yuv420p -s:v 720x480 -r 25 -i Mix_BostonHarbor_MainStreet_GrandBendPatio_720x480.yuv -c:v libx264 output.mp4</span><br></pre></td></tr></table></figure><h1><span id="how-to-generate-rgb444-fp16-file">How to generate RGB444 FP16 file</span></h1><p>Here is the guideline from Osman</p><h2><span id="install-ffmpeg-and-imagemagick">Install ffmpeg and imagemagick.</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install imagemagick ffmpeg</span><br></pre></td></tr></table></figure><h2><span id="first-convert-the-image-to-rgb-format-from-yuv420">First convert the image to RGB format from YUV420.</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -pix_fmt yuv420p -s 1920x1080 -i BostonHarbor_1920x1080.yuv -frames:v 10 -pix_fmt rgb48le BostonHarbor_1920x1080-rgb48le.rgb</span><br></pre></td></tr></table></figure><h2><span id="convert-more-formats">Convert more formats</span></h2><p>Then use the following imagemagick command to convert from RGB to RGBA FP16 format.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert -size 1920x1080 -depth 16 -colorspace rgb rgb:BostonHarbor_1920x1080-rgb48le.rgb -size 1920x1080 -depth 16 -define quantum:format=floating-point -colorspace rgb rgba:BostonHarbor_1920x1080-rgbafp16.rgb</span><br></pre></td></tr></table></figure><h2><span id="display-the-rgba-fp16-image">Display the RGBA FP16 image</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">display -size 1920x1080 -depth 16 -define quantum:format=floating-point -endian lsb rgba:BostonHarbor_1920x1080-rgbafp16.rgb</span><br></pre></td></tr></table></figure><h1><span id="my-work-flow-to-generate-custom-yuv-formats">My work flow to generate custom yuv formats</span></h1><blockquote><ol><li>Get some reference yuv files with ffmpeg or from web</li><li>Manual split and combine your custom YUV files with split\cat&gt;&gt; commond.</li><li>Encode your custom yuv to h264 with FFMPEG</li><li>Add number watermarker to your custom yuv file</li><li>Decode your custom bitstreams to different resolutions and formats.</li></ol></blockquote><h1><span id="yuv-view-tools">YUV view tools</span></h1><blockquote><p>vooya<br>7yuv</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Index:&lt;/p&gt;
&lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ffmpeg-convet-basic-usage&quot;&gt;FFMPEG convet basic usage&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#show-all-support-f</summary>
      
    
    
    
    
    <category term="H264" scheme="http://vball.fun/tags/H264/"/>
    
    <category term="FFMPEG" scheme="http://vball.fun/tags/FFMPEG/"/>
    
    <category term="YUV" scheme="http://vball.fun/tags/YUV/"/>
    
  </entry>
  
  <entry>
    <title>Zhuyin Pinyin 拼音注音編輯器</title>
    <link href="http://vball.fun/2021/11/02/toneoz/"/>
    <id>http://vball.fun/2021/11/02/toneoz/</id>
    <published>2021-11-02T08:37:22.000Z</published>
    <updated>2022-10-28T09:05:09.829Z</updated>
    
    <content type="html"><![CDATA[<p>好东西记录下来，并且安利一下。如果有人能看到的话。</p><h1><span id="遇到了一个好东西刚好给孩子学习拼音使用toneoz">遇到了一个好东西，刚好给孩子学习拼音使用–toneoz</span></h1><p>作者实现方法比较有意思，直接使用字体来实现注音标注，于是这个就可以在任意一个编辑器上使用，如果你的应用支持字体更换，那应用范围就更广了。</p><blockquote><p><a href="https://toneoz.com/">https://toneoz.com/</a><br><img src="/2021/11/02/toneoz/ksnip_20211103-154448.png"></p></blockquote><h2><span id="字体安装">字体安装</span></h2><p><a href="https://github.com/jeffreyxuan/toneoz-font-pinyin-kai">github</a>上边直接下载安装到系统字体库即可。。。大神，跪了</p><h2><span id="在线选音编辑器">在线选音编辑器</span></h2><p><a href="https://toneoz.com/ime">https://toneoz.com/ime</a></p><h2><span id="多音字处理">多音字处理</span></h2><p>考虑到中文存在多音字问题，作者提供了一个选音编辑器，可以非常方便的支持多音字的标注选择，选择完成后可以直接复制到word或者导出成图片。<br><img src="/2021/11/02/toneoz/ksnip_20211103-154040.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;好东西记录下来，并且安利一下。如果有人能看到的话。&lt;/p&gt;
&lt;h1&gt;&lt;span id=&quot;遇到了一个好东西刚好给孩子学习拼音使用toneoz&quot;&gt;遇到了一个好东西，刚好给孩子学习拼音使用–toneoz&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;作者实现方法比较有意思，直接使用字体来实现注音标</summary>
      
    
    
    
    
    <category term="toneoz" scheme="http://vball.fun/tags/toneoz/"/>
    
    <category term="pinyin" scheme="http://vball.fun/tags/pinyin/"/>
    
  </entry>
  
  <entry>
    <title>COVID-1984 is ready, will infect all the world, no one can survive</title>
    <link href="http://vball.fun/2021/10/27/1984/"/>
    <id>http://vball.fun/2021/10/27/1984/</id>
    <published>2021-10-27T07:56:47.000Z</published>
    <updated>2022-10-28T09:05:09.797Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="covid-1984-is-ready-will-infect-all-the-world-no-one-can-survive">COVID-1984 is ready, will infect all the world, no one can survive!</span></h1><p><img src="/2021/10/27/1984/ksnip_20211027-161028.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;covid-1984-is-ready-will-infect-all-the-world-no-one-can-survive&quot;&gt;COVID-1984 is ready, will infect all the world, no one can s</summary>
      
    
    
    
    
    <category term="1984" scheme="http://vball.fun/tags/1984/"/>
    
    <category term="Shit" scheme="http://vball.fun/tags/Shit/"/>
    
  </entry>
  
</feed>
